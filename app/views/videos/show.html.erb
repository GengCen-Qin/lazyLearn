<% content_for :title, @video.title || "视频播放器" %>

<%= stylesheet_link_tag "plyr", "data-turbo-track": "reload" %>
<%= stylesheet_link_tag "video_player_tailwind_fix", "data-turbo-track": "reload" %>
<%= stylesheet_link_tag "word_lookup", "data-turbo-track": "reload" %>

<div class="video-subtitle-app-container flex flex-col dark:bg-gray-900">
  <!--header-->
  <div class="dark:bg-gray-800 p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700">
    <div class="mx-auto">
      <div class="flex flex-row items-center sm:items-center sm:justify-between gap-3 sm:gap-4">
        <h1 class="text-gray-800 dark:text-gray-100 text-lg sm:text-xl md:text-2xl font-semibold truncate">
          <%= @video.title %>
        </h1>

        <!-- 显示转录状态 -->
        <span class="video-status <%= case @video.transcription_status
                                      when 'pending' then 'text-red-400 dark:text-red-500'
                                      when 'processing' then 'text-orange-600 dark:text-orange-500'
                                      when 'completed' then 'text-green-600 dark:text-green-500'
                                      when 'failed' then 'text-red-900 dark:text-red-400'
                                      else 'text-red-400 dark:text-red-500'
                                    end %> text-sm font-medium">
          <%= @video.transcription_status_text %>
        </span>
      </div>
    </div>
  </div>

  <!-- 主播放器布局 -->
  <div
    class="flex-1 overflow-hidden flex flex-col"
  >
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-3 sm:gap-4 md:gap-5 flex-1 overflow-hidden p-3 sm:p-4">
      <!--播放器-->
      <%= render 'videos/video_player', video: @video %>
      <!--字幕列表-->
      <%= render 'videos/subtitle_list', video: @video %>
    </div>

    <%= render 'videos/status_bar' %>
  </div>
</div>

<%= render 'videos/word_lookup_modal' %>
