// xgplayer@3.0.23 downloaded from https://ga.jspm.io/npm:xgplayer@3.0.23/es/index.js

import{S as t,I as i,P as a,E as n,a as s}from"../_/CjEvXaOl.js";export{b as langEn}from"../_/CjEvXaOl.js";import{_ as r,a as o,b as l,c as u,d,X as c,u as h,e as f,L as g,f as p,S as m,g as v,D as y,U as T,P as E,C as _,W as R,E as k,R as I,A as C,T as x,h as A,i as P,j as w,k as D,l as L,m as O,n as N,o as M,p as F,M as H,q as U,B as W,r as V,s as j,t as K,V as B,v as G,w as Y,x as X,y as z,z as J,F as q,G as Z,H as Q,I as $,J as ee,K as te}from"../_/B0bYmt-_.js";import{s as ie}from"../_/B64-s6V5.js";import{F as ae,R as ne,D as se,P as re,a as oe,b as le,L as ue,E as de,c as ce,K as he,d as fe,C as ge,M as pe,O as me}from"../_/BZUV4dKL.js";export{e as LivePreset}from"../_/BZUV4dKL.js";import{x as ve,P as ye}from"../_/DT8c2pCc.js";import Te from"./plugins/progress/index.js";import Ee from"./plugins/time/index.js";import _e from"./plugins/volume/index.js";import Se from"./plugins/start/index.js";import{P as Re,a as ke}from"../_/b4o-cJkt.js";import Ie from"eventemitter3";import"delegate";import Ce from"downloadjs";import{I as xe}from"../_/CGRmuyBC.js";import Ae from"./plugins/screenShot/index.js";import Pe from"./lang/zh-cn.js";export{S as STATES}from"../_/BuMQA3AN.js";import we from"danmu.js";import De from"xgplayer-subtitles";function Le(){return(new Date).getTime()}var Oe={LOAD_START:"loadstart",LOADED_DATA:"loadeddata",FIRST_FRAME:"firstFrame",WAIT_START:"waitingStart",WAIT_END:"waitingEnd",SEEK_START:"seekStart",SEEK_END:"seekEnd"};var be=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"_onTimeupdate",(function(){e._state.isTimeUpdate=true;if(e._state.autoplayStart){c.logInfo("[xgLogger]".concat(e.player.playerId," _onTimeupdate"));e._sendFF("onTimeupdate")}}));u(d(e),"_onAutoplayStart",(function(){c.logInfo("[xgLogger]".concat(e.player.playerId," _onAutoplayStart"));e._state.autoplayStart=true;e.vt&&e._sendFF("onAutoplayStart")}));u(d(e),"_onReset",(function(){e._state={autoplayStart:false,isFFLoading:false,isTimeUpdate:false,isFFSend:false,isLs:false};e.vt=0;e.pt=0;e.fvt=0;e.newPointTime=Le();e.loadedCostTime=0;e.startCostTime=0;e._isSeeking=false;e.seekingStart=0;e.waitingStart=0;e.fixedWaitingStart=0;e._isWaiting=false;e._waitTimer&&h.clearTimeout(d(e),e._waitTimer);e._waittTimer&&h.clearTimeout(d(e),e._waittTimer);e._waitTimer=null;e._waittTimer=null;e._waitType=0}));u(d(e),"_onSeeking",(function(){if(!e.seekingStart){e.suspendWaitingStatus("seek");e.seekingStart=Le();e.emitLog(Oe.SEEK_START,{start:Le()})}}));u(d(e),"_onSeeked",(function(){e.suspendSeekingStatus("seeked")}));u(d(e),"_onWaitingLoadStart",(function(){if(!e._isWaiting&&!e.vt){e._isWaiting=true;e.waitingStart=Le();e.fixedWaitingStart=Le();e._waitType=1;e.emitLog(Oe.WAIT_START,{fixedStart:e.fixedWaitingStart,start:e.waitingStart,type:1,endType:"loadstart"})}}));u(d(e),"_onWaiting",(function(){if(!e._isWaiting&&e.vt){e._isWaiting=true;e.vt?e.seekingStart?e._waitType=2:e._waitType=0:e._waitType=1;e.fixedWaitingStart=Le();e._waitTimer=h.setTimeout(d(e),(function(){if(e._isWaiting){e.waitingStart=Le();h.clearTimeout(d(e),e._waitTimer);e._waitTimer=null;e._startWaitTimeout();e.emitLog(Oe.WAIT_START,{fixedStart:e.fixedWaitingStart,start:e.waitingStart,type:e._waitType,endType:e._waitType===2?"seek":"playing"})}}),200)}}));u(d(e),"_onError",(function(){e.suspendSeekingStatus("error");e.suspendWaitingStatus("error")}));u(d(e),"_onPlaying",(function(){e._isWaiting&&e.suspendWaitingStatus("playing")}));return e}f(i,[{key:"afterCreate",value:function(){var e=this;this._onReset();this._waitType="firstFrame";this._initOnceEvents();this.newPointTime=Le();this.loadedCostTime=0;this.startCostTime=0;this.on(g,(function(){var t=e._state;var i=t.autoplayStart,a=t.isFFSend;e.startCostTime=Le()-e.newPointTime;c.logInfo("[xgLogger]".concat(e.player.playerId," LOAD_START"),"autoplayStart:".concat(i," isFFSend:").concat(a," startCostTime:").concat(e.startCostTime," newPointTime").concat(e.newPointTime));if(!a){!t.isLs&&e.emitLog(Oe.LOAD_START,{});t.isLs=true;t.isTimeUpdate=false;t.isFFLoading=true;e.pt=Le();e.vt=0;e.fvt=0;e._initOnceEvents();e._onWaitingLoadStart()}}));this.on(p,(function(){e.vt=Le();e.fvt=e.vt-e.pt;e.loadedCostTime=e.vt-e.newPointTime;var t=e._state,i=t.isTimeUpdate,a=t.isFFSend,n=t.autoplayStart;c.logInfo("[xgLogger]".concat(e.player.playerId," LOADED_DATA"),"fvt:".concat(e.fvt," isTimeUpdate:").concat(e._state.isTimeUpdate," loadedCostTime:").concat(e.loadedCostTime));(i||n)&&e._sendFF("loadedData");a||e.emitLog(Oe.LOADED_DATA,{});e.suspendWaitingStatus("loadeddata")}));this.on(m,this._onSeeking);this.on(v,this._onSeeked);this.on(y,(function(){e.endState("destroy")}));this.on(T,(function(){e.endState("urlChange");c.logInfo("[xgLogger]".concat(e.player.playerId," URL_CHANGE"));e._state.isFFSend&&e._onReset()}));this.on([E,_],this._onPlaying);this.on(R,this._onWaiting);this.on(k,this._onError);this.on(I,(function(){c.logInfo("[xgLogger]".concat(e.player.playerId," RESET"));e.endState("reset");e._initOnceEvents();e._onReset()}))}},{key:"_initOnceEvents",value:function(){this.off(C,this._onAutoplayStart);this.off(x,this._onTimeupdate);this.once(C,this._onAutoplayStart);this.once(x,this._onTimeupdate)}},{key:"_sendFF",value:function(e){this.s=Le();var t=this._state,i=t.isFFLoading,a=t.isFFSend;c.logInfo("[xgLogger]".concat(this.player.playerId," _sendFF"),"".concat(e," fvt:").concat(this.fvt," isFFLoading:").concat(i," !isFFSend:").concat(!a));if(this.vt>0&&i&&!a){c.logInfo("[xgLogger]".concat(this.player.playerId," emitLog_firstFrame"),e);this._state.isFFLoading=false;this._state.isFFSend=true;this.emitLog(Oe.FIRST_FRAME,{fvt:this.fvt,costTime:this.fvt,vt:this.vt,startCostTime:this.startCostTime,loadedCostTime:this.loadedCostTime})}}},{key:"_startWaitTimeout",value:function(){var e=this;this._waittTimer&&h.clearTimeout(this,this._waittTimer);this._waittTimer=h.setTimeout(this,(function(){e.suspendWaitingStatus("timeout");h.clearTimeout(e,e._waittTimer);e._waittTimer=null}),this.config.waitTimeout)}},{key:"endState",value:function(e){this.suspendWaitingStatus(e);this.suspendSeekingStatus(e)}},{key:"suspendSeekingStatus",value:function(e){if(this.seekingStart){var t=Le();var i=t-this.seekingStart;this.seekingStart=0;this.emitLog(Oe.SEEK_END,{end:t,costTime:i,endType:e})}}},{key:"suspendWaitingStatus",value:function(e){if(this._waitTimer){h.clearTimeout(this,this._waitTimer);this._waitTimer=null}if(this._waittTimer){h.clearTimeout(this,this._waittTimer);this._waittTimer=null}this._isWaiting=false;if(this.waitingStart){var t=Le();var i=t-this.waitingStart;var a=t-this.fixedWaitingStart;var n=this.config.waitTimeout;this._isWaiting=false;this.waitingStart=0;this.fixedWaitingStart=0;this.emitLog(Oe.WAIT_END,{fixedCostTime:a>n?n:a,costTime:i>n?n:i,type:e==="loadeddata"?1:this._waitType,endType:this._waitType===2?"seek":e})}}},{key:"emitLog",value:function(e,t){var i=this.player;this.emit(A,P({t:Le(),host:h.getHostFromUrl(i.currentSrc),vtype:i.vtype,eventType:e,currentTime:this.player.currentTime,readyState:i.video.readyState,networkState:i.video.networkState},t))}}],[{key:"pluginName",get:function(){return"xgLogger"}},{key:"defaultConfig",get:function(){return{waitTimeout:1e4}}}]);return i}(w);function Ne(){return(new DOMParser).parseFromString('<svg class="xgplayer-replay-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 78 78" width="78" height="78">\n  <path fill="#fff" transform="translate(20, 20)" d="M8.22708362,13.8757234 L11.2677371,12.6472196 C11.7798067,12.4403301 12.3626381,12.6877273 12.5695276,13.1997969 L12.9441342,14.1269807 C13.1510237,14.6390502 12.9036264,15.2218816 12.3915569,15.4287712 L6.8284538,17.6764107 L5.90126995,18.0510173 C5.38920044,18.2579068 4.80636901,18.0105096 4.5994795,17.49844 L1.97723335,11.0081531 C1.77034384,10.4960836 2.0177411,9.91325213 2.52981061,9.70636262 L3.45699446,9.33175602 C3.96906396,9.12486652 4.5518954,9.37226378 4.75878491,9.88433329 L5.67885163,12.1615783 C7.99551726,6.6766934 13.3983951,3 19.5,3 C27.7842712,3 34.5,9.71572875 34.5,18 C34.5,26.2842712 27.7842712,33 19.5,33 C15.4573596,33 11.6658607,31.3912946 8.87004692,28.5831991 C8.28554571,27.9961303 8.28762719,27.0463851 8.87469603,26.4618839 C9.46176488,25.8773827 10.4115101,25.8794641 10.9960113,26.466533 C13.2344327,28.7147875 16.263503,30 19.5,30 C26.127417,30 31.5,24.627417 31.5,18 C31.5,11.372583 26.127417,6 19.5,6 C14.4183772,6 9.94214483,9.18783811 8.22708362,13.8757234 Z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Me=function(e){r(i,e);var t=o(i);function i(){l(this,i);return t.apply(this,arguments)}f(i,[{key:"registerIcons",value:function(){return{replay:Ne}}},{key:"afterCreate",value:function(){var e=this;w.insert(this.icons.replay,this.root,0);this.__handleReplay=this.hook("replayClick",(function(){e.player.replay()}),{pre:function(e){e.preventDefault();e.stopPropagation()}});this.bind(".xgplayer-replay",["click","touchend"],this.__handleReplay);this.on(D,(function(){e.playerConfig.loop||h.addClass(e.player.root,"replay");if(!e.config.disable){e.show();var t=e.root.querySelector("path");if(t){var i=window.getComputedStyle(t).getPropertyValue("transform");if(typeof i==="string"&&i.indexOf("none")>-1)return null;t.setAttribute("transform",i)}}}));this.on(L,(function(){e.hide()}))}},{key:"handleReplay",value:function(e){e.preventDefault();e.stopPropagation();this.player.replay();h.removeClass(this.player.root,"replay")}},{key:"show",value:function(e){this.config.disable||(this.root.style.display="flex")}},{key:"enable",value:function(){this.config.disable=false}},{key:"disable",value:function(){this.config.disable=true;this.hide()}},{key:"destroy",value:function(){this.unbind(".xgplayer-replay",["click","touchend"],this.__handleReplay)}},{key:"render",value:function(){return'<xg-replay class="xgplayer-replay">\n      <xg-replay-txt class="xgplayer-replay-txt" lang-key="'.concat(this.i18nKeys.REPLAY,'">').concat(this.i18n.REPLAY,"</xg-replay-txt>\n    </xg-replay>")}}],[{key:"pluginName",get:function(){return"replay"}},{key:"defaultConfig",get:function(){return{disable:false}}}]);return i}(w);var Fe=function(e){r(i,e);var t=o(i);function i(){l(this,i);return t.apply(this,arguments)}f(i,[{key:"afterCreate",value:function(){this.getMini=this.getMini.bind(this);this.exitMini=this.exitMini.bind(this);this.bind("click",this.getMini)}},{key:"getMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"exitMini",value:function(){this.config.onClick&&this.config.onClick()}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="MINISCREEN";return'\n      <xg-icon class="xgplayer-miniicon">\n      <div class="xgplayer-icon btn-text"><span class="icon-text" lang-key="'.concat(this.i18nKeys[e],'">').concat(this.i18n[e],"</span></div>\n      </xg-icon>")}}],[{key:"pluginName",get:function(){return"miniscreenIcon"}},{key:"defaultConfig",get:function(){return{position:O.CONTROLS_RIGHT,index:10}}}]);return i}(w);function He(e){var t=parseFloat(e);var i=e.indexOf("%")===-1&&!Number.isNaN(t);return i&&t}var Ue=["paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];var We=Ue.length;function Ve(){var e={width:0,height:0,innerWidth:0,innerHeight:0,outerWidth:0,outerHeight:0};for(var t=0;t<We;t++){var i=Ue[t];e[i]=0}return e}function je(e){var t=window.getComputedStyle(e);return t}function Ke(e){typeof e==="string"&&(e=document.querySelector(e));if(e&&N(e)==="object"&&e.nodeType){var t=je(e);if(t.display==="none")return Ve();var i={};i.width=e.offsetWidth;i.height=e.offsetHeight;var a=i.isBorderBox=t.boxSizing==="border-box";for(var n=0;n<We;n++){var s=Ue[n];var r=t[s];var o=parseFloat(r);i[s]=Number.isNaN(o)?0:o}var l=i.paddingLeft+i.paddingRight;var u=i.paddingTop+i.paddingBottom;var d=i.marginLeft+i.marginRight;var c=i.marginTop+i.marginBottom;var h=i.borderLeftWidth+i.borderRightWidth;var f=i.borderTopWidth+i.borderBottomWidth;var g=a;var p=He(t.width);p!==false&&(i.width=p+(g?0:l+h));var m=He(t.height);m!==false&&(i.height=m+(g?0:u+f));i.innerWidth=i.width-(l+h);i.innerHeight=i.height-(u+f);i.outerWidth=i.width+d;i.outerHeight=i.height+c;return i}}function Be(e,t){for(var i=0;i<e.length;i++){var a=e[i];if(a.identifier===t)return a}}var Ge={START:"dragStart",MOVE:"dragMove",ENDED:"dragEnded"};var Ye={mousedown:["mousemove","mouseup"],touchstart:["touchmove","touchend","touchcancel"],pointerdown:["pointermove","pointerup","pointercancel"]};var Xe=function(e){r(i,e);var t=o(i);function i(e){var a;var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l(this,i);a=t.call(this);a.isEnabled=true;a.isDragging=false;a.isDown=false;a.position={};a.downPoint={};a.dragPoint={x:0,y:0};a.startPos={x:0,y:0};a._root=e instanceof Element?e:document.querySelector(e);a._handlerDom=n.handle instanceof Element?n.handle:document.querySelector(n.handle);if(!a._root||!a._handlerDom)return M(a);a._bindStartEvent();return a}f(i,[{key:"_bindStartEvent",value:function(){var e=this;"ontouchstart"in window?this._startKey="touchstart":this._startKey="mousedown";this["on".concat(this._startKey)]=this["on".concat(this._startKey)].bind(this);this._handlerDom.addEventListener(this._startKey,this["on".concat(this._startKey)]);Ye[this._startKey].map((function(t){e["on".concat(t)]=e["on".concat(t)].bind(e)}))}},{key:"_unbindStartEvent",value:function(){this._handlerDom.removeEventListener(this._startKey,this["on".concat(this._startKey)])}},{key:"_bindPostStartEvents",value:function(e){var t=this;if(e){var i=Ye[this._startKey];i.map((function(e){window.addEventListener(e,t["on".concat(e)])}));this._boundPointerEvents=i}}},{key:"_unbindPostStartEvents",value:function(){var e=this;if(this._boundPointerEvents){this._boundPointerEvents.map((function(t){window.removeEventListener(t,e["on".concat(t)])}));delete this._boundPointerEvents}}},{key:"enable",value:function(){this.isEnabled=true}},{key:"disable",value:function(){this.isEnabled=false;this.isDragging&&this.onUp()}},{key:"onDocUp",value:function(e){this.onUp()}},{key:"animate",value:function(){var e=this;if(this.isDragging){this.positionDrag();window.requestAnimationFrame((function(){e.animate()}))}}},{key:"positionDrag",value:function(){var e="translate3d(".concat(this.dragPoint.x,"px, ").concat(this.dragPoint.y,"px, 0)");this._root.style.transform=e;this._root.style.webKitTransform=e}},{key:"setLeftTop",value:function(){this._root.style.left=this.position.x+"px";this._root.style.top=this.position.y+"px"}},{key:"onmousedown",value:function(e){this.dragStart(e,e)}},{key:"onmousemove",value:function(e){this.dragMove(e,e)}},{key:"onmouseup",value:function(e){this.dragEnd(e,e)}},{key:"ontouchstart",value:function(e){var t=e.changedTouches[0];this.dragStart(e,t);this.touchIdentifier=t.pointerId!==void 0?t.pointerId:t.identifier;e.preventDefault()}},{key:"ontouchmove",value:function(e){var t=Be(e.changedTouches,this.touchIdentifier);t&&this.dragMove(e,t)}},{key:"ontouchend",value:function(e){var t=Be(e.changedTouches,this.touchIdentifier);t&&this.dragEnd(e,t);e.preventDefault()}},{key:"ontouchcancel",value:function(e){var t=Be(e.changedTouches,this.touchIdentifier);t&&this.dragCancel(e,t)}},{key:"dragStart",value:function(e,t){if(this._root&&!this.isDown&&this.isEnabled){this.downPoint=t;this.dragPoint.x=0;this.dragPoint.y=0;this._getPosition();var i=Ke(this._root);this.startPos.x=this.position.x;this.startPos.y=this.position.y;this.startPos.maxY=window.innerHeight-i.height;this.startPos.maxX=window.innerWidth-i.width;this.setLeftTop();this.isDown=true;this._bindPostStartEvents(e)}}},{key:"dragRealStart",value:function(e,t){this.isDragging=true;this.animate();this.emit(Ge.START,this.startPos)}},{key:"dragEnd",value:function(e,t){if(this._root){this._unbindPostStartEvents();if(this.isDragging){this._root.style.transform="";this.setLeftTop();this.emit(Ge.ENDED)}this.presetInfo()}}},{key:"_dragPointerMove",value:function(e,t){var i={x:t.pageX-this.downPoint.pageX,y:t.pageY-this.downPoint.pageY};!this.isDragging&&this.hasDragStarted(i)&&this.dragRealStart(e,t);return i}},{key:"dragMove",value:function(e,t){e=e||window.event;if(this.isDown){var i=this.startPos,a=i.x,n=i.y;var s=this._dragPointerMove(e,t);var r=s.x;var o=s.y;r=this.checkContain("x",r,a);o=this.checkContain("y",o,n);this.position.x=a+r;this.position.y=n+o;this.dragPoint.x=r;this.dragPoint.y=o;this.emit(Ge.MOVE,this.position)}}},{key:"dragCancel",value:function(e,t){this.dragEnd(e,t)}},{key:"presetInfo",value:function(){this.isDragging=false;this.startPos={x:0,y:0};this.dragPoint={x:0,y:0};this.isDown=false}},{key:"destroy",value:function(){this._unbindStartEvent();this._unbindPostStartEvents();this.isDragging&&this.dragEnd();this.removeAllListeners();this._handlerDom=null}},{key:"hasDragStarted",value:function(e){return Math.abs(e.x)>3||Math.abs(e.y)>3}},{key:"checkContain",value:function(e,t,i){return t+i<0?0-i:e==="x"&&t+i>this.startPos.maxX?this.startPos.maxX-i:e==="y"&&t+i>this.startPos.maxY?this.startPos.maxY-i:t}},{key:"_getPosition",value:function(){var e=window.getComputedStyle(this._root);var t=this._getPositionCoord(e.left,"width");var i=this._getPositionCoord(e.top,"height");this.position.x=Number.isNaN(t)?0:t;this.position.y=Number.isNaN(i)?0:i;this._addTransformPosition(e)}},{key:"_addTransformPosition",value:function(e){var t=e.transform;if(t.indexOf("matrix")===0){var i=t.split(",");var a=t.indexOf("matrix3d")===0?12:4;var n=parseInt(i[a],10);var s=parseInt(i[a+1],10);this.position.x+=n;this.position.y+=s}}},{key:"_getPositionCoord",value:function(e,t){if(e.indexOf("%")!==-1){var i=Ke(this._root.parentNode);return i?parseFloat(e)/100*i[t]:0}return parseInt(e,10)}}]);return i}(Ie);var ze=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);u(d(a),"onCancelClick",(function(e){a.exitMini();a.isClose=true}));u(d(a),"onCenterClick",(function(e){var t=d(a),i=t.player;i.paused?i.play():i.pause()}));u(d(a),"onScroll",(function(e){if(!(!window.scrollY&&window.scrollY!==0||Math.abs(window.scrollY-a.pos.scrollY)<50)){var t=parseInt(h.getCss(a.player.root,"height"));t+=a.config.scrollTop;a.pos.scrollY=window.scrollY;if(window.scrollY>t+5)!a.isMini&&!a.isClose&&a.getMini();else if(window.scrollY<=t){a.isMini&&a.exitMini();a.isClose=false}}}));a.isMini=false;a.isClose=false;var n=d(a),s=n.config;a.pos={left:s.left<0?window.innerWidth-s.width-20:s.left,top:s.top<0?window.innerHeight-s.height-20:s.top,height:a.config.height,width:a.config.width,scrollY:window.scrollY||0};a.lastStyle=null;return a}f(i,[{key:"beforeCreate",value:function(e){typeof e.player.config.mini==="boolean"&&(e.config.isShowIcon=e.player.config.mini)}},{key:"afterCreate",value:function(){var e=this;this.initIcons();this.on(F,(function(){e.setAttr("data-state","pause")}));this.on(L,(function(){e.setAttr("data-state","play")}))}},{key:"onPluginsReady",value:function(){var e=this;var t=this.player,i=this.config;if(!i.disable){if(this.config.isShowIcon){var a={config:{onClick:function(){e.getMini()}}};t.controls.registerPlugin(Fe,a,Fe.pluginName)}var n=h.checkTouchSupport()?"touchend":"click";this.bind(".mini-cancel-btn",n,this.onCancelClick);this.bind(".play-icon",n,this.onCenterClick);this.config.disableDrag||(this._draggabilly=new Xe(this.player.root,{handle:this.root}));this.config.isScrollSwitch&&window.addEventListener("scroll",this.onScroll)}}},{key:"registerIcons",value:function(){return{play:{icon:ke,class:"xg-icon-play"},pause:{icon:Re,class:"xg-icon-pause"}}}},{key:"initIcons",value:function(){var e=this.icons;this.appendChild(".play-icon",e.play);this.appendChild(".play-icon",e.pause)}},{key:"getMini",value:function(){var e=this;if(!this.isMini){var t=this.player,i=this.playerConfig;var a=this.config.target||this.player.root;this.lastStyle={};h.addClass(t.root,"xgplayer-mini");["width","height","top","left"].map((function(t){e.lastStyle[t]=a.style[t];a.style[t]="".concat(e.pos[t],"px")}));i.fluid&&(a.style["padding-top"]="");this.emit(H,true);t.isMini=this.isMini=true}}},{key:"exitMini",value:function(){var e=this;if(!this.isMini)return false;var t=this.player,i=this.playerConfig;var a=this.config.target||this.player.root;h.removeClass(t.root,"xgplayer-mini");this.lastStyle&&Object.keys(this.lastStyle).map((function(t){a.style[t]=e.lastStyle[t]}));this.lastStyle=null;if(i.fluid){t.root.style.width="100%";t.root.style.height="0";t.root.style["padding-top"]="".concat(i.height*100/i.width,"%")}this.emit(H,false);this.isMini=t.isMini=false}},{key:"updatePos",value:function(e){this.pos=Object.assign(this.pos,e);if(this.isMini){this.player.root.style.left="".concat(this.pos.left,"px");this.player.root.style.top="".concat(this.pos.top,"px");this.player.root.style.width="".concat(this.pos.width,"px");this.player.root.style.height="".concat(this.pos.height,"px")}}},{key:"destroy",value:function(){window.removeEventListener("scroll",this.onScroll);var e=h.checkTouchSupport()?"touchend":"click";this.unbind(".mini-cancel-btn",e,this.onCancelClick);this.unbind(".play-icon",e,this.onCenterClick);this._draggabilly&&this._draggabilly.destroy();this._draggabilly=null;this.exitMini()}},{key:"render",value:function(){if(!this.config.disable)return'\n      <xg-mini-layer class="xg-mini-layer">\n      <xg-mini-header class="xgplayer-mini-header">\n      '.concat(ve(this,"MINI_DRAG",this.playerConfig.isHideTips),'\n      </xg-mini-header>\n      <div class="mini-cancel-btn">\n        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">\n          <path fill="#fff" fill-rule="evenodd" d="M3.99 3.49a1 1 0 0 1 1.414 0L10 8.085l4.596-4.595a1 1 0 1 1 1.414 1.414L11.414 9.5l4.596 4.596a1 1 0 0 1 .084 1.32l-.084.094a1 1 0 0 1-1.414 0L10 10.914 5.404 15.51a1 1 0 0 1-1.414-1.414L8.585 9.5 3.99 4.904a1 1 0 0 1-.084-1.32z"></path>\n        </svg>\n      </div>\n      <div class="play-icon">\n      </div>\n      </xg-mini-layer>')}}],[{key:"pluginName",get:function(){return"miniscreen"}},{key:"defaultConfig",get:function(){return{index:10,disable:false,width:320,height:180,left:-1,top:-1,isShowIcon:false,isScrollSwitch:false,scrollTop:0,disableDrag:false}}}]);return i}(w);var Je=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"_onDurationChange",(function(){e.updateSegments();var t=e.player,i=t.currentTime,a=t.timeSegments;if(e._checkIfEnabled(a)){var n=h.getIndexByTime(i,a);var s=h.getOffsetCurrentTime(i,a,n);e.player.offsetCurrentTime=s;e.changeIndex(n,a)}}));u(d(e),"_onLoadedData",(function(){var t=e.player.timeSegments;if(e._checkIfEnabled(t)){var i=h.getOffsetCurrentTime(0,t);e.player.offsetCurrentTime=i;e.changeIndex(0,t);e.curPos.start>0&&(e.player.currentTime=e.curPos.start)}}));u(d(e),"_onTimeupdate",(function(){var t=e.player,i=t.currentTime,a=t.timeSegments;if(e._checkIfEnabled(a)){var n=a.length;e.lastCurrentTime=i;var s=h.getIndexByTime(i,a);s!==e.curIndex&&e.changeIndex(s,a);var r=h.getOffsetCurrentTime(i,a,s);e.player.offsetCurrentTime=r;if(e.curPos){var o=e.curPos,l=o.start,u=o.end;i<l?e.player.currentTime=l:i>u&&s>=n-1&&e.player.pause()}}}));u(d(e),"_onSeeking",(function(){var t=e.player,i=t.currentTime,a=t.timeSegments;if(e._checkIfEnabled(a))if(i<a[0].start)e.player.currentTime=a[0].start;else if(i>a[a.length-1].end)e.player.currentTime=a[a.length-1].end;else{var n=h.getIndexByTime(i,a);if(n>=0){var s=e.getSeekTime(i,e.lastCurrentTime,n,a);s>=0&&(e.player.currentTime=s)}}}));u(d(e),"_onPlay",(function(){var t=e.player,i=t.currentTime,a=t.timeSegments;e._checkIfEnabled(a)&&i>=a[a.length-1].end&&(e.player.currentTime=a[0].start)}));return e}f(i,[{key:"afterCreate",value:function(){this.curIndex=-1;this.curPos=null;this.lastCurrentTime=0;this.updateSegments();this.on(U,this._onDurationChange);this.on(p,this._onLoadedData);this.on(x,this._onTimeupdate);this.on(m,this._onSeeking);this.on(L,this._onPlay)}},{key:"setConfig",value:function(e){var t=this;if(e){var i=Object.keys(e);if(!(i.length<1)){i.forEach((function(i){t.config[i]=e[i]}));this.updateSegments()}}}},{key:"updateSegments",value:function(){var e=this.config,t=e.disable,i=e.segments;var a=this.player;if(t||!i||i.length===0){a.timeSegments=[];a.offsetDuration=0;a.offsetCurrentTime=-1}else{var n=this.formatTimeSegments(i,a.duration);a.timeSegments=n;a.offsetDuration=n.length>0?n[n.length-1].duration:0}}},{key:"formatTimeSegments",value:function(e,t){var i=[];if(!e)return[];e.sort((function(e,t){return e.start-t.start}));e.forEach((function(e,a){var n={};n.start=e.start<0?0:e.start;n.end=t>0&&e.end>t?t:e.end;if(!(t>0&&n.start>t)){i.push(n);var s=n.end-n.start;if(a===0){n.offset=e.start;n.cTime=0;n.segDuration=s;n.duration=s}else{var r=i[a-1];n.offset=r.offset+(n.start-r.end);n.cTime=r.duration+r.cTime;n.segDuration=s;n.duration=r.duration+s}}}));return i}},{key:"getSeekTime",value:function(e,t,i,a){var n=-1;var s=a[i],r=s.start,o=s.end;if(e>=r&&e<=o)return n;var l=e-t;if(l<0&&e<r){var u=t>r?t-r:0;n=i-1>=0?a[i-1].end+l+u:0;return n}return-1}},{key:"_checkIfEnabled",value:function(e){return!(!e||e.length<1)}},{key:"changeIndex",value:function(e,t){this.curIndex=e;e>=0&&t.length>0?this.curPos=t[e]:this.curPos=null}}],[{key:"pluginName",get:function(){return"TimeSegmentsControls"}},{key:"defaultConfig",get:function(){return{disable:true,segments:[]}}}]);return i}(W);function qe(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="40" viewBox="10 0 24 40">\n  <path transform="scale(0.038 0.028)" d="M800 380v768h-128v-352l-320 320v-704l320 320v-352z"></path>\n</svg>\n',"image/svg+xml").firstChild}var Ze=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);u(d(a),"playNext",(function(e){var t=d(a),i=t.player;e.preventDefault();e.stopPropagation();if(a.idx+1<a.config.urlList.length){a.idx++;a.nextHandler(a.config.urlList[a.idx],a.idx);i.emit(V,a.idx+1)}else{a.nextHandler();i.emit(V)}}));a.idx=-1;return a}f(i,[{key:"afterCreate",value:function(){if(this.config.urlList&&this.config.urlList.length!==0){this.appendChild(".xgplayer-icon",this.icons.playNext);this.initEvents()}}},{key:"registerIcons",value:function(){return{playNext:qe}}},{key:"initEvents",value:function(){this.nextHandler=this.hook("nextClick",this.changeSrc);var e=ie.device==="mobile"?"touchend":"click";this.bind(e,this.playNext);this.show()}},{key:"changeSrc",value:function(e){var t=this.player;if(e){t.pause();t.currentTime=0;t.switchURL?t.switchURL(e):t.src=e;t.config.url=e;t.play()}}},{key:"destroy",value:function(){this.unbind(["touchend","click"],this.playNext)}},{key:"render",value:function(){if(this.config.urlList&&this.config.urlList.length!==0)return'\n     <xg-icon class="xgplayer-playnext">\n      <div class="xgplayer-icon">\n      </div>\n      '.concat(ve(this,"PLAYNEXT_TIPS",this.playerConfig.isHideTips),"\n     </xg-icon>\n    ")}}],[{key:"pluginName",get:function(){return"playNext"}},{key:"defaultConfig",get:function(){return{position:O.CONTROLS_LEFT,index:1,url:null,urlList:[]}}}]);return i}(w);function Qe(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 24 24">\n  <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n    <g transform="translate(-488.000000, -340.000000)" fill="#FFFFFF">\n      <g id="Group-2">\n        <g id="volme_big-copy" transform="translate(488.000000, 340.000000)">\n          <rect id="Rectangle-18" x="11" y="4" width="2" height="12" rx="1"></rect>\n          <rect id="Rectangle-2" x="3" y="18" width="18" height="2" rx="1"></rect>\n          <rect id="Rectangle-2" transform="translate(4.000000, 17.500000) rotate(90.000000) translate(-4.000000, -17.500000) " x="1.5" y="16.5" width="5" height="2" rx="1"></rect><rect id="Rectangle-2-Copy-3" transform="translate(20.000000, 17.500000) rotate(90.000000) translate(-20.000000, -17.500000) " x="17.5" y="16.5" width="5" height="2" rx="1"></rect>\n          <path d="M9.48791171,8.26502656 L9.48791171,14.2650266 C9.48791171,14.8173113 9.04019646,15.2650266 8.48791171,15.2650266 C7.93562696,15.2650266 7.48791171,14.8173113 7.48791171,14.2650266 L7.48791171,7.26502656 C7.48791171,6.71274181 7.93562696,6.26502656 8.48791171,6.26502656 L15.4879117,6.26502656 C16.0401965,6.26502656 16.4879117,6.71274181 16.4879117,7.26502656 C16.4879117,7.81731131 16.0401965,8.26502656 15.4879117,8.26502656 L9.48791171,8.26502656 Z" id="Combined-Shape" transform="translate(11.987912, 10.765027) scale(1, -1) rotate(45.000000) translate(-11.987912, -10.765027) "></path>\n        </g>\n      </g>\n    </g>\n  </g>\n</svg>\n',"image/svg+xml").firstChild}var $e=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);u(d(a),"download",(function(e){if(!a.isLock){a.emitUserAction(e,"download");var t=a.playerConfig.url;var i="";h.typeOf(t)==="String"?i=t:h.typeOf(t)==="Array"&&t.length>0&&(i=t[0].src);var n=a.getAbsoluteURL(i);Ce(n);a.isLock=true;a.timer=window.setTimeout((function(){a.isLock=false;window.clearTimeout(a.timer);a.timer=null}),300)}}));a.timer=null;a.isLock=false;return a}f(i,[{key:"afterCreate",value:function(){j(K(i.prototype),"afterCreate",this).call(this);if(!this.config.disable){this.appendChild(".xgplayer-icon",this.icons.download);this._handler=this.hook("click",this.download,{pre:function(e){e.preventDefault();e.stopPropagation()}});this.bind(["click","touchend"],this._handler)}}},{key:"registerIcons",value:function(){return{download:Qe}}},{key:"getAbsoluteURL",value:function(e){if(!e.match(/^https?:\/\//)){var t=document.createElement("div");t.innerHTML='<a href="'.concat(e,'">x</a>');e=t.firstChild.href}return e}},{key:"destroy",value:function(){j(K(i.prototype),"destroy",this).call(this);this.unbind(["click","touchend"],this.download);window.clearTimeout(this.timer);this.timer=null}},{key:"render",value:function(){if(!this.config.disable)return'<xg-icon class="xgplayer-download">\n   <div class="xgplayer-icon">\n   </div>\n   '.concat(ve(this,"DOWNLOAD_TIPS",this.playerConfig.isHideTips),"\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"download"}},{key:"defaultConfig",get:function(){return{position:O.CONTROLS_RIGHT,index:3,disable:true}}}]);return i}(xe);var et=function(e){r(a,e);var i=o(a);function a(){l(this,a);return i.apply(this,arguments)}f(a,[{key:"afterCreate",value:function(){var e=this;this.intervalId=0;this.customConfig=null;this.bind(".highlight",["click","touchend"],(function(t){if(e.config.onClick||e.customOnClick){t.preventDefault();t.stopPropagation();e.customOnClick?e.customOnClick(t):e.config.onClick(t)}}));this.player.showPrompt=function(){e.showPrompt.apply(e,arguments)};this.player.hidePrompt=function(){e.hide()}}},{key:"setStyle",value:function(e){var t=this;Object.keys(e).map((function(i){t.root.style[i]=e[i]}))}},{key:"showPrompt",value:function(e){var t=this;var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){};if(e){this.customOnClick=a;var n=this.config.interval;if(this.intervalId){clearTimeout(this.intervalId);this.intervalId=null}h.addClass(this.root,"show");i.mode==="arrow"&&h.addClass(this.root,"arrow");this.find(".xgplayer-prompt-detail").innerHTML=typeof e==="string"?e:"".concat(e.text||"")+"".concat(e.highlight?'<i class="highlight">'.concat(e.highlight,"</i>"):"");i.style&&this.setStyle(i.style);var s=typeof i.autoHide==="boolean"?i.autoHide:this.config.autoHide;if(s){var r=i.interval||n;this.intervalId=setTimeout((function(){t.hide()}),r)}}}},{key:"hide",value:function(){h.removeClass(this.root,"show");h.removeClass(this.root,"arrow");this.root.removeAttribute("style");this.customOnClick=null}},{key:"render",value:function(){return'<xg-prompt class="xgplayer-prompt '.concat(t.CONTROLS_FOLLOW,'">\n    <span class="xgplayer-prompt-detail"></span>\n    </xg-prompt>')}}],[{key:"pluginName",get:function(){return"prompt"}},{key:"defaultConfig",get:function(){return{interval:3e3,style:{},mode:"arrow",autoHide:true,detail:{text:"",highlight:""},onClick:function(){}}}}]);return a}(w);var tt={time:0,text:"",id:1,duration:1,color:"#fff",style:{},width:6,height:6};function it(e){Object.keys(tt).map((function(t){e[t]===void 0&&(e[t]=tt[t])}))}var at={_updateDotDom:function(e,t){if(t){var i=this.calcuPosition(e.time,e.duration);var a=e.style||{};a.left="".concat(i.left,"%");a.width="".concat(i.width,"%");t.setAttribute("data-text",e.text);t.setAttribute("data-time",e.time);i.isMini?h.addClass(t,"mini"):h.removeClass(t,"mini");Object.keys(a).map((function(e){t.style[e]=a[e]}))}},initDots:function(){var e=this;this._ispots.map((function(t){e.createDot(t,false)}));this.ispotsInit=true},createDot:function(e){var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];var i=this.player.plugins.progress;if(i){if(t){it(e);this._ispots.push(e)}if(this.ispotsInit||!t){var a=this.calcuPosition(e.time,e.duration);var n=e.style||{};n.left="".concat(a.left,"%");n.width="".concat(a.width,"%");var s="xgspot_".concat(e.id," xgplayer-spot");a.isMini&&(s+=" mini");var r=e.template?'<div class="xgplayer-spot-pop">'.concat(e.template,"</div>"):"";var o=h.createDom("xg-spot",r,{"data-text":e.text,"data-time":e.time,"data-id":e.id},s);Object.keys(n).map((function(e){o.style[e]=n[e]}));i.outer&&i.outer.appendChild(o);this.positionDot(o,e.id)}}},findDot:function(e){if(this.player.plugins.progress){var t=this._ispots.filter((function(t,i){return t.id===e}));return t.length>0?t[0]:null}},updateDot:function(e){var t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];var i=this.player.plugins.progress;if(i){var a=this.findDot(e.id);a&&Object.keys(e).map((function(t){a[t]=e[t]}));if(this.ispotsInit){var n=i.find('xg-spot[data-id="'.concat(e.id,'"]'));if(n){this._updateDotDom(e,n);t&&this.showDot(e.id)}}}},deleteDot:function(e){var t=this._ispots;var i=this.player.plugins.progress;if(i){var a=[];for(var n=0;n<t.length;n++)t[n].id===e&&a.push(n);var s=a.length;for(var r=s-1;r>=0;r--){t.splice(a[r],1);if(this.ispotsInit){var o=i.find('xg-spot[data-id="'.concat(e,'"]'));o&&o.parentElement.removeChild(o)}}}},deleteAllDots:function(){var e=this.player.plugins.progress;if(e)if(this.ispotsInit){var t=e.root.getElementsByTagName("xg-spot");for(var i=t.length-1;i>=0;i--)e.outer.removeChild(t[i]);this._ispots=[]}else this._ispots=[]},updateAllDots:function(){var e=this;var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var i=this.player.plugins.progress;if(i)if(this.ispotsInit){this._ispots=[];var a=i.root.getElementsByTagName("xg-spot");var n=a.length;if(n>t.length)for(var s=n-1;s>t.length-1;s--)i.outer.removeChild(a[s]);t.forEach((function(t,i){if(i<n){a[i].setAttribute("data-id","".concat(t.id));e._ispots.push(t);e.updateDot(t)}else e.createDot(t)}))}else this._ispots=t},positionDots:function(){var e=this;var t=this._ispots,i=this.playerSize;var a=this.player.sizeInfo;var n=this.player.plugins.progress;if(n&&a.width!==i.width){i.width=a.width;i.left=a.left;t.forEach((function(t){var i=n.find('xg-spot[data-id="'.concat(t.id,'"]'));i&&e.positionDot(i,t.id)}))}},positionDot:function(e,t){var i=h.findDom(e,".xgplayer-spot-pop");if(i){var a=this.playerSize;var n=e.getBoundingClientRect();var s=i.getBoundingClientRect();var r=n.left-a.left;var o=a.width-r-n.width/2;if(r<s.width/2||a.width<s.width){var l=s.width/2-r;i.style.left="".concat(l,"px")}else if(o<s.width/2){var u=o-s.width/2+n.width/2;i.style.left="".concat(u,"px")}else i.style.left="50%"}},updateDuration:function(){var e=this;var t=this.player.plugins.progress;if(t){var i=this._ispots;i.forEach((function(i){var a=t.find('xg-spot[data-id="'.concat(i.id,'"]'));e._updateDotDom(i,a)}))}},getAllDotsDom:function(){var e=this.player.plugins.progress;if(!e)return[];var t=e.root.getElementsByTagName("xg-spot");return t},getDotDom:function(e){var t=this.player.plugins.progress;if(t)return t.find('xg-spot[data-id="'.concat(e,'"]'))}};function nt(e){var t=e.config,i=e.player;Object.keys(at).map((function(t){e[t]=at[t].bind(e)}));var a=i.config.progressDot||t.ispots||[];e._ispots=a.map((function(e){it(e);return e}));e.ispotsInit=false;e.playerSize={left:i.sizeInfo.left,width:i.sizeInfo.width};e.on(U,(function(){e.ispotsInit?e.updateDuration():e.initDots()}));e.on(B,(function(){e.positionDots()}))}var st={dragmove:"onProgressMove",dragstart:"onProgressDragStart",dragend:"onProgressDragEnd",click:"onProgressClick",mouseover:"onProgressMouseOver",mouseenter:"onProgressMouseOver"};var rt=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);u(d(a),"onMousemove",(function(e){if(!a.config.disable)if(h.hasClass(e.target,"xg-spot-content")&&a.config.isHideThumbnailHover)a.player.plugins.progress.onMouseLeave(e);else if(a._state.f||h.hasClass(e.target,"xg-spot-content")){h.event(e);e.stopPropagation()}}));u(d(a),"onMousedown",(function(e){if(!a.config.disable&&(a._state.f||h.hasClass(e.target,"xg-spot-content"))){h.event(e);e.stopPropagation()}}));u(d(a),"onMouseup",(function(e){if(a.isDrag){var t=a.player.plugins.progress;if(t&&t.pos){t.onMouseUp(e);!t.pos.isEnter&&t.onMouseLeave(e)}}}));u(d(a),"onDotMouseLeave",(function(e){if(!a.config.disable){a._curDot.removeEventListener("mouseleave",a.onDotMouseLeave);a.blurDot(e.target);a._curDot=null;var t=a.player.plugins.progress;t&&t.enableBlur();a.show()}}));u(d(a),"onProgressMouseOver",(function(e,t){if(!a.config.disable&&h.hasClass(t.target,"xgplayer-spot")&&!a._curDot){a._curDot=t.target;a.focusDot(t.target);a._curDot.children.length>0&&a.hide();var i=a.player.plugins.progress;i&&i.disableBlur();a._curDot.addEventListener("mouseleave",a.onDotMouseLeave)}}));a._ispots=[];a.videoPreview=null;a.videothumbnail=null;a.thumbnail=null;a.timeStr="";a._state={now:0,f:false};return a}f(i,[{key:"beforeCreate",value:function(e){var t=e.player.plugins.progress;t&&(e.root=t.root)}},{key:"afterCreate",value:function(){var e=this;this._curDot=null;this.handlerSpotClick=this.hook("spotClick",(function(t,i){i.seekTime&&e.player.seek(i.seekTime)}));this.transformTimeHook=this.hook("transformTime",(function(t){e.setTimeContent(h.format(t))}));nt(this);this.on(U,(function(){e.show()}));this.config.disable&&this.disable();this.extTextRoot=this.find(".xg-spot-ext-text")}},{key:"setConfig",value:function(e){var t=this;e&&Object.keys(e).map((function(i){t.config[i]=e[i]}))}},{key:"onPluginsReady",value:function(){var e=this.player;if(e.plugins.progress){this.previewLine=this.find(".xg-spot-line");this.timePoint=this.find(".xgplayer-progress-point");this.timeText=this.find(".xg-spot-time");this.tipText=this.find(".spot-inner-text");this._hasThumnail=false;this.registerThumbnail();this.bindEvents()}}},{key:"bindEvents",value:function(){var e=this;var t=this.player.plugins.progress;if(t){Object.keys(st).map((function(i){e[st[i]]=e[st[i]].bind(e);t.addCallBack(i,e[st[i]])}));if(ie.device!=="mobile"){this.bind(".xg-spot-info","mousemove",this.onMousemove);this.bind(".xg-spot-info","mousedown",this.onMousedown);this.bind(".xg-spot-info","mouseup",this.onMouseup);var i=this.hook("previewClick",(function(){}));this.handlerPreviewClick=function(a){a.stopPropagation();i(parseInt(e._state.now*1e3,10)/1e3,a);t&&t.onMouseUp(a)};this.bind(".xg-spot-content","mouseup",this.handlerPreviewClick)}}}},{key:"onProgressMove",value:function(e,t){!this.config.disable&&this.player.duration&&this.updatePosition(e.offset,e.width,e.currentTime,e.e)}},{key:"onProgressDragStart",value:function(e){if(!this.config.disable&&this.player.duration){this.isDrag=true;this.videoPreview&&h.addClass(this.videoPreview,"show")}}},{key:"onProgressDragEnd",value:function(e){if(!this.config.disable&&this.player.duration){this.isDrag=false;this.videoPreview&&h.removeClass(this.videoPreview,"show")}}},{key:"onProgressClick",value:function(e,t){if(!this.config.disable&&h.hasClass(t.target,"xgplayer-spot")){t.stopPropagation();t.preventDefault();["time","id","text"].map((function(i){e[i]=t.target.getAttribute("data-".concat(i))}));e.time&&(e.time=Number(e.time));this.handlerSpotClick(t,e)}}},{key:"updateLinePos",value:function(e,t){var i=this.root,a=this.previewLine,n=this.player,s=this.config;var r=n.controls.mode;var o=r==="flex";var l=i.getBoundingClientRect().width;if(l||!this._hasThumnail){l=this._hasThumnail&&l<s.width?s.width:l;var u=e-l/2;var d;if(u<0&&!o){u=0;d=e-l/2}else if(u>t-l&&!o){d=u-(t-l);u=t-l}else d=0;d!==void 0&&(a.style.transform="translateX(".concat(d.toFixed(2),"px)"));i.style.transform="translateX(".concat(u.toFixed(2),"px) translateZ(0)")}}},{key:"updateTimeText",value:function(e){var t=this.timeText,i=this.timePoint;t.innerHTML=e;!this.thumbnail&&(i.innerHTML=e)}},{key:"updatePosition",value:function(e,t,i,a){var n=this.root,s=this.config,r=this._state;if(n){r.now=i;this.transformTimeHook(i);var o=this.timeStr;if(a&&a.target&&h.hasClass(a.target,"xgplayer-spot")){this.showTips(a.target.getAttribute("data-text"),false,o);this.focusDot(a.target);r.f=true;s.isFocusDots&&r.f&&(r.now=parseInt(a.target.getAttribute("data-time"),10))}else if(s.defaultText){r.f=false;this.showTips(s.defaultText,true,o)}else{r.f=false;this.hideTips("")}this.updateTimeText(o);this.updateThumbnails(r.now);this.updateLinePos(e,t)}}},{key:"setTimeContent",value:function(e){this.timeStr=e}},{key:"updateThumbnails",value:function(e){var t=this.player,i=this.videoPreview,a=this.config;var n=t.plugins.thumbnail;if(n&&n.usable){this.thumbnail&&n.update(this.thumbnail,e,a.width,a.height);var s=i&&i.getBoundingClientRect();this.videothumbnail&&n.update(this.videothumbnail,e,s.width,s.height)}}},{key:"registerThumbnail",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(ie.device!=="mobile"){var t=this.player,i=this.config;var a=t.getPlugin("thumbnail");a&&a.setConfig(e);if(a&&a.usable&&i.isShowThumbnail){h.removeClass(this.root,"short-line no-thumbnail");i.mode==="short"&&h.addClass(this.root,"short-line");this._hasThumnail=true;var n=this.find(".xg-spot-thumbnail");this.thumbnail=a.createThumbnail(n,"progress-thumbnail");if(i.isShowCoverPreview){this.videoPreview=h.createDom("xg-video-preview","",{},"xgvideo-preview");t.root.appendChild(this.videoPreview);this.videothumbnail=a.createThumbnail(this.videoPreview,"xgvideo-thumbnail")}this.updateThumbnails(0)}else h.addClass(this.root,"short-line no-thumbnail")}}},{key:"calcuPosition",value:function(e,t){var i=this.player.plugins.progress;var a=this.player;var n=i.root.getBoundingClientRect().width;var s=a.duration/n*6;e+t>a.duration&&(t=a.duration-e);e/a.duration*100;t/a.duration;return{left:e/a.duration*100,width:t/a.duration*100,isMini:t<s}}},{key:"showDot",value:function(e){var t=this.findDot(e);if(t){var i=this.root.getBoundingClientRect();var a=i.width;var n=t.time/this.player.duration*a;this.updatePosition(n,a,t.time)}}},{key:"focusDot",value:function(e,t){if(e){t||(t=e.getAttribute("data-id"));h.addClass(e,"active");this._activeDotId=t}}},{key:"blurDot",value:function(e){if(!e){var t=this._activeDotId;e=this.getDotDom(t)}if(e){h.removeClass(e,"active");this._activeDotId=null}}},{key:"showTips",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";h.addClass(this.root,"no-timepoint");if(e){h.addClass(this.find(".xg-spot-content"),"show-text");if(t&&this.config.mode==="production"){h.addClass(this.root,"product");this.tipText.textContent=e}else{h.removeClass(this.root,"product");this.tipText.textContent=this._hasThumnail?e:"".concat(i," ").concat(e)}}}},{key:"hideTips",value:function(){h.removeClass(this.root,"no-timepoint");this.tipText.textContent="";h.removeClass(this.find(".xg-spot-content"),"show-text");h.removeClass(this.root,"product")}},{key:"hide",value:function(){h.addClass(this.root,"hide")}},{key:"show",value:function(e){h.removeClass(this.root,"hide")}},{key:"enable",value:function(){var e=this.config,t=this.playerConfig;this.config.disable=false;this.show();!this.thumbnail&&e.isShowThumbnail&&this.registerThumbnail(t.thumbnail||{})}},{key:"disable",value:function(){this.config.disable=true;this.hide()}},{key:"destroy",value:function(){var e=this;var t=this.player.plugins.progress;t&&Object.keys(st).map((function(i){t.removeCallBack(i,e[st[i]])}));this.videothumbnail=null;this.thumbnail=null;this.videoPreview&&this.player.root.removeChild(this.videoPreview);this.unbind(".xg-spot-info","mousemove",this.onMousemove);this.unbind(".xg-spot-info","mousedown",this.onMousedown);this.unbind(".xg-spot-info","mouseup",this.onMouseup);this.unbind(".xg-spot-content","mouseup",this.handlerPreviewClick)}},{key:"render",value:function(){return ie.device==="mobile"||this.playerConfig.isMobileSimulateMode==="mobile"?"":'<div class="xg-spot-info hide '.concat(this.config.mode==="short"?"short-line":"",'">\n      <div class="xg-spot-content">\n        <div class="xg-spot-thumbnail">\n          <span class="xg-spot-time"></span>\n        </div>\n        <div class="xg-spot-text"><span class="spot-inner-text"></span></div>\n      </div>\n      <div class="xgplayer-progress-point">00:00</div>\n      <div class="xg-spot-ext-text"></div>\n      <div class="xg-spot-line"></div>\n    </div>')}}],[{key:"pluginName",get:function(){return"progresspreview"}},{key:"defaultConfig",get:function(){return{index:1,miniWidth:6,ispots:[],defaultText:"",isFocusDots:true,isHideThumbnailHover:true,isShowThumbnail:true,isShowCoverPreview:false,mode:"",disable:false,width:160,height:90}}}]);return i}(w);var ot=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);a.ratio=1;a.interval=null;a._preloadMark={};return a}f(i,[{key:"afterCreate",value:function(){var e=this;this.usable&&this.initThumbnail();this.on([U],(function(){var t=e.config,i=t.pic_num,a=t.interval;e.usable&&(e.interval=a>0?a:Math.round(e.player.duration*1e3/i)/1e3)}))}},{key:"setConfig",value:function(e){var t=this;if(e){var i=Object.keys(e);if(!(i.length<1)){i.forEach((function(i){t.config[i]=e[i]}));this.usable&&this.initThumbnail()}}}},{key:"usable",get:function(){var e=this.config,t=e.urls,i=e.pic_num;return t&&t.length>0&&i>0}},{key:"initThumbnail",value:function(){var e=this.config,t=e.width,i=e.height,a=e.pic_num,n=e.interval;this.ratio=t/i*100;this.interval=n||Math.round(this.player.duration/a);this._preloadMark={}}},{key:"getUrlByIndex",value:function(e){return e>=0&&e<this.config.urls.length?this.config.urls[e]:""}},{key:"preload",value:function(e){var t=this;if(!this._preloadMark[e]){var i=this.config.urls;var a=i.length;var n=[];e>0&&n.push(e-1);n.push(e);e>0&&e<a-1&&n.push(e+1);n.map((function(e){if(!t._preloadMark[e]&&e>=0&&e<a){t._preloadMark[e]=1;h.preloadImg(i[e],(function(){t._preloadMark[e]=2}))}}))}}},{key:"getPosition",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;var a=this.config,n=a.pic_num,s=a.row,r=a.col,o=a.width,l=a.height;this.interval=Math.round(this.player.duration/n);var u=Math.ceil(e/this.interval);u=u>n?n:u;var d=u<s*r?0:Math.ceil(u/(s*r))-1;var c=u-d*(r*s);var h=c>0?Math.ceil(c/r)-1:0;var f=c>0?c-h*r-1:0;var g=0;var p=0;if(t&&i){var m=t/i;if(m<o/l){p=i;g=p*(o/l)}else{g=t;p=g/(o/l)}}else if(i){if(!t){p=i||l;g=p*(o/l)}}else{g=t||o;p=g/(o/l)}var v=this.getUrlByIndex(d);return{urlIndex:d,rowIndex:h,colIndex:f,url:v,height:p,width:g,style:{backgroundImage:"url(".concat(v,")"),backgroundSize:"".concat(g*r,"px auto"),backgroundPosition:"-".concat(f*g,"px -").concat(h*p,"px"),width:"".concat(g,"px"),height:"".concat(p,"px")}}}},{key:"update",value:function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;var n=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"";var s=this.config,r=s.pic_num,o=s.urls;if(!(r<=0)&&o&&o.length!==0){var l=this.getPosition(t,i,a);this.preload(l.urlIndex);Object.keys(l.style).map((function(t){e.style[t]=l.style[t]}));Object.keys(n).map((function(t){e.style[t]=n[t]}))}}},{key:"changeConfig",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.setConfig(e)}},{key:"createThumbnail",value:function(e,t){var i=h.createDom("xg-thumbnail","",{},"thumbnail ".concat(t));e&&e.appendChild(i);return i}}],[{key:"pluginName",get:function(){return"thumbnail"}},{key:"defaultConfig",get:function(){return{isShow:false,urls:[],pic_num:0,col:0,row:0,height:90,width:160,scale:1,className:"",hidePortrait:false}}}]);return i}(w);function lt(e){return e?"background:".concat(e,";"):""}var ut=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"onTimeupdate",(function(){var t=e.player.ended;var i=d(e),a=i.offsetDuration;var n=e.currentTime;n=h.adjustTimeByDuration(n,a,t);e.update({played:n},a)}));return e}f(i,[{key:"offsetDuration",get:function(){return this.playerConfig.customDuration||this.player.offsetDuration||this.player.duration}},{key:"currentTime",get:function(){var e=this.player,t=e.offsetCurrentTime,i=e.currentTime;return t>=0?t:i}},{key:"afterCreate",value:function(){var e=this;if(this.root){this.on(x,this.onTimeupdate);this.on(G,(function(){e.reset()}))}}},{key:"reset",value:function(){this.update({played:0,cached:0},0)}},{key:"update",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{cached:0,played:0};var t=arguments.length>1?arguments[1]:void 0;if(t&&this.root){e.cached&&(this.find("xg-mini-progress-cache").style.width="".concat(e.cached/t*100,"%"));e.played&&(this.find("xg-mini-progress-played").style.width="".concat(e.played/t*100,"%"))}}},{key:"render",value:function(){var e=this.playerConfig,t=e.commonStyle,i=e.miniprogress;if(i){var a=this.config,n=a.mode,s=a.height;var r={cached:lt(t.cachedColor),played:lt(t.playedColor),progress:lt(t.progressColor),height:s>0&&s!==2?"height: ".concat(s,"px;"):""};var o=n==="show"?"xg-mini-progress-show":"";return'<xg-mini-progress class="xg-mini-progress '.concat(o,'" style="').concat(r.progress," ").concat(r.height,'">\n    <xg-mini-progress-cache class="xg-mini-progress-cache" style="').concat(r.cached,'"></xg-mini-progress-cache>\n    <xg-mini-progress-played class="xg-mini-progress-played" style="').concat(r.played,'"></xg-mini-progress-played>\n    </xg-mini-progress>')}}}],[{key:"pluginName",get:function(){return"MiniProgress"}},{key:"defaultConfig",get:function(){return{mode:"auto",height:2}}}]);return i}(w);var dt={REAL_TIME:"realtime",FIRST_FRAME:"firstframe",FRAME_RATE:"framerate",POSTER:"poster"};function ct(){try{return parseInt(window.performance.now(),10)}catch(e){return(new Date).getTime()}}function ht(){try{var e=document.createElement("canvas").getContext;return!!e}catch(e){return false}}var ft=null;var gt=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"onLoadedData",(function(t){if(e.player){e._frameCount=e.config.startFrameCount;e.stop();e.renderOnTimeupdate(t);e.off(x,e.renderOnTimeupdate);e.on(x,e.renderOnTimeupdate)}}));u(d(e),"onVisibilitychange",(function(t){document.visibilityState==="visible"?e._checkIfCanStart()&&e.start():document.visibilityState==="hidden"&&e.stop()}));u(d(e),"renderOnTimeupdate",(function(t){if(e._frameCount>0){e.renderOnce();e._frameCount--}else{e._isLoaded=true;e.off(x,e.renderOnTimeupdate);var i=e.config.startInterval;!e.player.paused&&e._checkIfCanStart()&&e.start(0,i)}}));u(d(e),"start",(function(t,i){var a=e.player.video;var n=ct();var s=e.checkVideoIsSupport(a);if(s&&e.canvasCtx){i||(i=e.interval);e.stop();if(a.videoWidth&&a.videoHeight){e.videoPI=a.videoHeight>0?parseInt(a.videoWidth/a.videoHeight*100,10):0;if(e.config.mode===dt.REAL_TIME){a&&a.videoWidth&&e.update(s,e.videoPI);e.preTime=n}else if(n-e.preTime>=i){a&&a.videoWidth&&e.update(s,e.videoPI);e.preTime=n}}e.frameId=e._loopType==="timer"?h.setTimeout(d(e),e.start,i):h.requestAnimationFrame(e.start)}}));u(d(e),"stop",(function(){if(e.frameId){e._loopType==="timer"?h.clearTimeout(d(e),e.frameId):h.cancelAnimationFrame(e.frameId);e.frameId=null}}));return e}f(i,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.dynamicBg===true&&(this.config.disable=false);i.isSupport||(this.config.disable=true);var t=this.config,a=t.disable,n=t.mode,s=t.frameRate;if(!a){this._pos={width:0,height:0,rwidth:0,rheight:0,x:0,y:0,pi:0};this.isStart=false;this._isLoaded=false;this.videoPI=0;this.preTime=0;this.interval=parseInt(1e3/s,10);this.canvas=null;this.canvasCtx=null;this._frameCount=0;this._loopType=this.config.mode!==dt.REAL_TIME&&this.interval>=1e3?"timer":"animation";this.once(Y,(function(){if(e.player){e.init();e.renderByPoster();e.player.paused||e.start()}}));if(n!==dt.POSTER){if(n!==dt.FIRST_FRAME){this.on(G,(function(){e.stop()}));this.on(L,(function(){var t=e.config.startInterval;e._checkIfCanStart()&&e.start(0,t)}));this.on(F,(function(){e.stop()}))}this.on(p,this.onLoadedData);this.on(g,(function(){e._isLoaded=false;e.stop()}));document.addEventListener("visibilitychange",this.onVisibilitychange)}}}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach((function(i){i==="root"&&e[i]!==t.config[i]?t.reRender(e[i]):i==="frameRate"?t.interval=parseInt(1e3/e[i],10):i==="disable"&&e[i]&&t.stop();t.config[i]=e[i]}))}},{key:"init",value:function(e){var t=this.player,a=this.config;this.canvasFilter=i.supportCanvasFilter();try{var n=e||a.root;n||(n=a.isInnerRender&&t.innerContainer||t.root);n.insertAdjacentHTML("afterbegin",'<div class="xgplayer-dynamic-bg" data-index="'.concat(a.index,'"><canvas>\n        </canvas><xgmask></xgmask></div>'));this.root=n.children[0];this.canvas=this.find("canvas");if(!this.canvasFilter){this.canvas.style.filter=a.filter;this.canvas.style.webkitFilter=a.filter}this.mask=this.find("xgmask");a.addMask&&(this.mask.style.background=a.maskBg);this.canvasCtx=this.canvas.getContext("2d")}catch(e){c.logError("plugin:DynamicBg",e)}}},{key:"reRender",value:function(e){var t=this.config.disable;if(t||this.root){this.stop();var i=this.root?this.root.parentElement:null;i!==e&&i.removeChild(this.root);if(e){this.init(e);this.renderOnce();var a=this.config.startInterval;this._checkIfCanStart()&&this.start(0,a)}else this.root=null}}},{key:"checkVideoIsSupport",value:function(e){if(!e)return null;var t=e&&e instanceof window.HTMLVideoElement?e:e.canvas?e.canvas:e.flyVideo?e.flyVideo:null;if(t&&!(ie.browser==="safari"&&h.isMSE(t)))return t;var i=t?t.tagName.toLowerCase():"";return i==="canvas"||i==="img"?t:null}},{key:"renderByPoster",value:function(){var e=this.playerConfig.poster;if(e){var t=h.typeOf(e)==="String"?e:h.typeOf(e.poster)==="String"?e.poster:null;this.updateImg(t)}}},{key:"_checkIfCanStart",value:function(){var e=this.config.mode;return this._isLoaded&&!this.player.paused&&e!==dt.FIRST_FRAME&&e!==dt.POSTER}},{key:"renderOnce",value:function(){var e=this.player.video;if(e.videoWidth&&e.videoHeight){this.videoPI=parseInt(e.videoWidth/e.videoHeight*100,10);var t=this.checkVideoIsSupport(e);t&&this.update(t,this.videoPI)}}},{key:"updateImg",value:function(e){var t=this;if(e){var i=this.canvas.getBoundingClientRect(),a=i.width,n=i.height;var s=new window.Image;s.onload=function(){if(t.canvas&&!t.frameId&&!t.isStart){t.canvas.height=n;t.canvas.width=a;var e=parseInt(a/n*100,10);t.update(s,e);s=null}};s.src=e}}},{key:"update",value:function(e,t){if(this.canvas&&this.canvasCtx&&t)try{var i=this._pos,a=this.config;var n=this.canvas.getBoundingClientRect(),s=n.width,r=n.height;if(s!==i.width||r!==i.height||i.pi!==t){var o=parseInt(s/r*100,10);i.pi=t;i.width!==s&&(i.width=this.canvas.width=s);i.height!==r&&(i.height=this.canvas.height=r);var l=r;var u=s;o<t?u=parseInt(r*t/100,10):o>t&&(l=parseInt(s*100/t,10));i.rwidth=u*a.multiple;i.rheight=l*a.multiple;i.x=(s-i.rwidth)/2;i.y=(r-i.rheight)/2}this.canvasFilter&&(this.canvasCtx.filter=a.filter);this.canvasCtx.drawImage(e,i.x,i.y,i.rwidth,i.rheight)}catch(e){c.logError("plugin:DynamicBg",e)}}},{key:"destroy",value:function(){this.stop();document.removeEventListener("visibilitychange",this.onVisibilitychange);this.canvasCtx=null;this.canvas=null}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"dynamicBg"}},{key:"defaultConfig",get:function(){return{isInnerRender:false,disable:true,index:-1,mode:"framerate",frameRate:10,filter:"blur(50px)",startFrameCount:2,startInterval:0,addMask:true,multiple:1.2,maskBg:"rgba(0,0,0,0.7)"}}},{key:"isSupport",get:function(){if(typeof ft==="boolean")return ft;ft=ht();return ft}},{key:"supportCanvasFilter",value:function(){return!(ie.browser==="safari"||ie.browser==="firefox")}}]);return i}(w);var pt="info";var mt=X;var vt=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"_recordUserActions",(function(t){var i=e._getTime();var a=Object.assign({},t,{msg:t.msg||t.action});e._stats[pt].push(P(P({type:"userAction"},i),{},{payload:a}))}));u(d(e),"_onReset",(function(){e.reset()}));u(d(e),"_recordInfo",(function(t){e.info(t)}));u(d(e),"_downloadStats",(function(){var t=e.getStats();var i=new Blob([JSON.stringify(t)],{type:"application/json"});var a=window.URL.createObjectURL(i);var n=document.createElement("a");n.style.display="none";n.href=a;n.download="player.txt";n.disabled=false;n.click()}));return e}f(i,[{key:"_getTime",value:function(){return{timestamp:Date.now(),timeFormat:(new Date).toISOString()}}},{key:"afterCreate",value:function(){this.reset();this.on(z,this._recordUserActions);this.on(mt.STATS_INFO,this._recordInfo);this.on(mt.STATS_DOWNLOAD,this._downloadStats);this.on(mt.STATS_RESET,this._onReset)}},{key:"destroy",value:function(){this.offAll()}},{key:"downloadStats",value:function(){this._downloadStats()}},{key:"info",value:function(e){e.profile?this._infoProfile(e):this._info(e)}},{key:"_info",value:function(e){var t=this._getTime();this._stats[pt].push(P(P({},t),{},{payload:e}))}},{key:"_infoProfile",value:function(e){if(e&&e.startMs){var t=Date.now();var i=t-e.startMs;var a=P({cat:"function",dur:i,name:e.name||e.msg,ph:"X",pid:0,tid:0,ts:e.startMs,profile:true},e);this._info(a)}else console.warn("infoProfile need object data, include startMs")}},{key:"reset",value:function(){var e;this._stats=(e={},u(e,pt,[]),u(e,"media",{}),e)}},{key:"getStats",value:function(){var e=this.player;var t=e.media;var i=[];for(var a=0;a<t.buffered.length;a++)i.push({start:t.buffered.start(a),end:t.buffered.end(a)});var n={currentTime:t.currentTime,readyState:t.readyState,buffered:i,paused:t.paused,ended:t.ended};this._stats.media=n;return{raw:this._stats,timestat:this._getTimeStats(),profile:this._getProfile()}}},{key:"_getTimeStats",value:function(){var e=this._stats[pt];var t=e.map((function(e){var t=e.payload.data;var i="";try{t instanceof Error?i=t.msg:t!==void 0&&(i=JSON.stringify(t))}catch(e){console.log("err",e)}return"[".concat(e.timeFormat,"] : ").concat(e.payload.msg," ").concat(i," ")}));return t}},{key:"_getProfile",value:function(){var e={traceEvents:[]};var t=this._stats[pt];t.forEach((function(t){t.payload.profile&&e.traceEvents.push(t.payload)}));return e}}],[{key:"pluginName",get:function(){return"stats"}},{key:"defaultConfig",get:function(){return{}}}]);return i}(W);var yt=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"onGapJump",(function(){var t=d(e),a=t.player,n=t.config;if(a.media.readyState!==HTMLMediaElement.HAVE_NOTHING){if(a.media.seeking){if(!e.seekingEventReceived)return}else e.seekingEventReceived=false;if(!a.media.paused||a.media.currentTime===0||!e.hasPlayed){var s=a.media.buffered;var r=n.smallGapLimit||.5;var o=n.gapDetectionThreshold||.3;var l=a.media.currentTime;var u=e._getIndex(s,l,o);if(u!==null&&u!==0){console.log("GapJump  bufferRange ",s.start(u),s.end(u));var c=s.start(u)+.1;var h=a.media.duration;if(!(c>h)){var f=c-l;var g=f<=r;if(!(f<i.BROWSER_GAP_TOLERANCE)&&g){n.useGapJump!==false&&(a.media.currentTime=e.isSafari?c+.1:c);e.player&&e.player.emit("detectGap");console.log("gapJump gapIndex",u," isGapSamll:",g," currentTime:",a.media.currentTime," jumpSize:",l-a.media.currentTime);c!==.08&&a&&a.emit("log",{type:"oneevent",end_type:"gap",vid:a.config.vid,ext:{video_postion:Math.floor(c*1e3)}})}}}}}}));return e}f(i,[{key:"afterCreate",value:function(){var e=this;var t=this.config.useGapJump;if(t!==false){this.hasPlayed=false;this.seekingEventReceived=false;this.isSafari=/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);this.on(R,this.onGapJump);this.on(L,(function(){e.hasPlayed=true}));this.on(m,(function(){e.seekingEventReceived=true}))}}},{key:"_getIndex",value:function(e,t,i){if(!e||!e.length)return null;if(e.length===1&&e.end(0)-e.start(0)<1e-6)return null;var a=this._getBuffered(e);var n=null;for(var s=0;s<a.length;s++){var r=a[s];if(r.start>t&&(s===0||a[s-1].end-t<=i)){n=s;break}}return n}},{key:"_getBuffered",value:function(e){if(!e)return[];var t=[];for(var i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}}],[{key:"pluginName",get:function(){return"gapJump"}},{key:"defaultConfig",get:function(){return{useGapJump:false,smallGapLimit:.5,gapDetectionThreshold:.3}}}]);return i}(w);yt.BROWSER_GAP_TOLERANCE=.001;var Tt=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"onWaiting",(function(){var t=d(e),i=t.config;e.jumpCnt>i.jumpCntMax||e.timer||i.useWaitingTimeoutJump===false||(e.timer=setTimeout(e.onJump,i.waitingTime*1e3))}));u(d(e),"onJump",(function(){var t=d(e),i=t.player,a=t.config;clearTimeout(e.timer);e.timer=null;if(!(e.jumpCnt>a.jumpCntMax||a.useWaitingTimeoutJump===false)&&(!i.media.paused||i.media.currentTime===0||!e.hasPlayed)){e.jumpSize=a.jumpSize*(e.jumpCnt+1);e.jumpCnt===a.jumpSize&&e.jumpSize<6&&(e.jumpSize=6);var n=i.currentTime+e.jumpSize;var s=i.media.duration;if(!(n>s)){e.jumpCnt++;i.currentTime=n}}}));return e}f(i,[{key:"afterCreate",value:function(){var e=this;var t=this.config,i=t.useWaitingTimeoutJump,a=t.jumpSize;if(i!==false){this.hasPlayed=false;this.jumpCnt=0;this.timer=null;this.jumpSize=a;this.on(R,this.onWaiting);this.on([E,_],(function(){clearTimeout(e.timer);e.timer=null;e.jumpSize=e.config.jumpSize}));this.on(L,(function(){e.hasPlayed=true}))}}}],[{key:"pluginName",get:function(){return"waitingTimeoutJump"}},{key:"defaultConfig",get:function(){return{useWaitingTimeoutJump:false,waitingTime:15,jumpSize:2,jumpCntMax:4}}}]);return i}(w);var Et="cdn";var _t=["cdn"];var St=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"getSpeed",(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Et;if(!e.speedListCache||!e.speedListCache[t])return 0;if(e.speedListCache[t].length<=0)return 0;var i=0;e.speedListCache[t].map((function(e){i+=e}));return Math.floor(i/e.speedListCache[t].length)}));u(d(e),"startTimer",(function(){if(!h.isMSE(e.player.video)){e.initSpeedList();e.cnt=0;e.timer=setTimeout(e.testSpeed,e.config.testTimeStep)}}));u(d(e),"initSpeedList",(function(){e.speedListCache={};_t.forEach((function(t){e.speedListCache[t]=[]}))}));u(d(e),"_onRealSpeedChange",(function(t){t.speed&&e.appendList(t.speed,t.type||Et)}));u(d(e),"testSpeed",(function(){clearTimeout(e.timer);e.timer=null;if(e.player&&e.config.openSpeed){var t=e.config,i=t.url,a=t.loadSize,n=t.testCnt,s=t.testTimeStep;var r=i+(i.indexOf("?")<0?"?testst=":"&testst=")+Date.now();if(!(e.cnt>=n)){e.cnt++;try{var o=(new Date).getTime();var l=null;var u=new XMLHttpRequest;e.xhr=u;u.open("GET",r);var d={};var c=Math.floor(Math.random()*10);d.Range="bytes="+c+"-"+(a+c);d&&Object.keys(d).forEach((function(e){u.setRequestHeader(e,d[e])}));u.onreadystatechange=function(){if(u.readyState===4){e.xhr=null;l=(new Date).getTime();var t=u.getResponseHeader("Content-Length")/1024*8;var i=Math.round(t*1e3/(l-o));e.appendList(i);e.timer=setTimeout(e.testSpeed,s)}};u.send()}catch(e){console.error(e)}}}}));u(d(e),"appendList",(function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Et;if(e.speedListCache&&e.speedListCache[i]){var a=e.config.saveSpeedMax;e.speedListCache[i].length>=a&&e.speedListCache[i].shift();e.speedListCache[i].push(t);var n=d(e),s=n.player;s&&(i===Et?s.realTimeSpeed=t:s[e.getSpeedName("realTime",i)]=t);e.updateSpeed(i)}}));u(d(e),"updateSpeed",(function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Et;var i=e.getSpeed(t);var a=d(e),n=a.player;if(n)if(t===Et){if(!n.avgSpeed||i!==n.avgSpeed){n.avgSpeed=i;n.emit(J,{speed:i,realTimeSpeed:n.realTimeSpeed})}}else{var s=e.getSpeedName("avg",t);if(!n[s]||i!==n[s]){n[s]=i;n.emit(J,{speed:i,realTimeSpeed:n.realTimeSpeed})}}}));return e}f(i,[{key:"afterCreate",value:function(){var e=this.config,t=e.openSpeed,i=e.addSpeedTypeList;(i===null||i===void 0?void 0:i.length)>0&&_t.push.apply(_t,q(i));this.initSpeedList();this.on("real_time_speed",this._onRealSpeedChange);this.timer=null;this.cnt=0;this.xhr=null;t&&this.on([p,Z],this.startTimer)}},{key:"getSpeedName",value:function(e,t){return e+"Speed"+t.toUpperCase()}},{key:"openSpeed",get:function(){return this.config.openSpeed},set:function(e){this.config.openSpeed=e;if(e||!this.timer){if(this.config.openSpeed){if(this.timer)return;this.timer=setTimeout(this.testSpeed,this.config.testTimeStep)}}else{clearTimeout(this.timer);this.timer=null}}},{key:"destroy",value:function(){var e=this;this.off("real_time_speed",this._onRealSpeedChange);this.off([p,Z],this.startTimer);_t.forEach((function(t){e.speedListCache&&e.speedListCache[t]&&(e.speedListCache[t]=[])}));this.speedListCache&&(this.speedListCache={});clearTimeout(this.timer);this.timer=null;if(this.xhr&&this.xhr.readyState!==4){this.xhr.cancel&&this.xhr.cancel();this.xhr=null}}}],[{key:"pluginName",get:function(){return"testspeed"}},{key:"defaultConfig",get:function(){return{openSpeed:false,testCnt:3,loadSize:204800,testTimeStep:3e3,url:"",saveSpeedMax:5,addSpeedTypeList:[]}}}]);return i}(w);var Rt=function(e){r(i,e);var t=o(i);function i(){l(this,i);return t.apply(this,arguments)}f(i,[{key:"afterCreate",value:function(){var e=this;var t=this.player,i=this.config;var a=t.media||t.video;this.timer=null;this._lastDecodedFrames=0;this._currentStuckCount=0;this._lastCheckPoint=null;this._payload=[];if(!i.disabled){var n=a.getVideoPlaybackQuality;if(n){this.on(L,(function(){e._startTick()}));this.on(F,(function(){e._stopTick()}));this.on(D,(function(){e._stopTick()}));this.on(G,(function(){e._stopTick()}))}}}},{key:"_startTick",value:function(){var e=this;this._stopTick();this._timer=setTimeout((function(){e._checkDecodeFPS();e._startTick()}),this.config.tick)}},{key:"_stopTick",value:function(){clearTimeout(this._timer);this._timer=null}},{key:"_checkBuffer",value:function(e,t){var i=false;var a=[];for(var n=0;n<t.length;n++){var s=t.start(n);var r=t.end(n);a.push({start:s,end:r});if(s<=e&&e<=r-1){i=true;break}}return{enoughBuffer:i,buffers:a}}},{key:"_checkStuck",value:function(e,t,i,a){var n=this.player.media||this.player.video;var s=document.hidden;var r=n.paused,o=n.readyState,l=n.currentTime,u=n.buffered;if(!(s||r||o<4)){var d=this._checkBuffer(l,u),c=d.enoughBuffer,h=d.buffers;if(c)if(e<=this.config.reportFrame){this._currentStuckCount++;this._payload.push({currentTime:l,buffers:h,curDecodedFrames:e,totalVideoFrames:t,droppedVideoFrames:i,checkInterval:a});if(this._currentStuckCount>=this.config.stuckCount){this.emit(Q,this._payload);this._reset()}}else this._reset()}}},{key:"_reset",value:function(){this._payload=[];this._currentStuckCount=0}},{key:"_checkDecodeFPS",value:function(){var e=this.player.media||this.player.video;if(e){var t=e.getVideoPlaybackQuality(),i=t.totalVideoFrames,a=t.droppedVideoFrames;var n=performance.now();if(i&&this._lastCheckPoint){var s=i-this._lastDecodedFrames;var r=n-this._lastCheckPoint;this._checkStuck(s,i,a,r)}this._lastDecodedFrames=i;this._lastCheckPoint=n}}},{key:"destroy",value:function(){this._stopTick()}}],[{key:"pluginName",get:function(){return"FpsDetect"}},{key:"defaultConfig",get:function(){return{disabled:false,tick:1e3,stuckCount:3,reportFrame:0}}}]);return i}(w);i.use(Pe);var kt=f((function e(t,i){var a,n,s;l(this,e);var r=i&&i.isMobileSimulateMode==="mobile";var o=i.isLive;var u=o?[]:[Je,Te,ut,rt,Ee];var d=[].concat(u,[ye,ae,ne,Ze,se,re,$e,Ae,_e,oe]);var c=[Me,le,Se,ue,de,ce,et,ot,ze];this.plugins=[vt,be].concat(q(d),c,[yt,Tt]);var h=r?"mobile":ie.device;switch(h){case"pc":(a=this.plugins).push.apply(a,[he,fe,ge,St,Rt]);break;case"mobile":(n=this.plugins).push.apply(n,[pe]);break;default:(s=this.plugins).push.apply(s,[he,fe,ge])}(ie.os.isIpad||h==="pc")&&this.plugins.push(gt);ie.os.isIpad&&this.plugins.push(fe);this.ignores=[];this.i18n=[]}));var It=function(e){r(i,e);var t=o(i);function i(){l(this,i);return t.apply(this,arguments)}return f(i)}(a);u(It,"defaultPreset",kt);u(It,"Util",h);u(It,"Sniffer",ie);u(It,"Errors",n);u(It,"Events",$);u(It,"Plugin",w);u(It,"BasePlugin",W);u(It,"I18N",i);u(It,"STATE_CLASS",t);u(It,"InstManager",s);u(It,"PlayIcon",ye);u(It,"TimeIcon",Ee);u(It,"Progress",Te);u(It,"FullscreenIcon",ae);u(It,"CssFullscreenIcon",ge);u(It,"VolumeIcon",_e);var Ct=f((function e(t,i){var a,n,s;l(this,e);var r=i&&i.isMobileSimulateMode==="mobile";var o=i.isLive;var u=o?[]:[Te,ut,rt,Ee];var d=[].concat(u,[ye,ae,ne,Ze,se,re,$e,Ae,_e,oe]);var c=[Me,le,Se,ue,de,ce,et,ot,ze];this.plugins=[vt,be].concat(q(d),c,[yt,Tt]);var h=r?"mobile":ie.device;switch(h){case"pc":(a=this.plugins).push.apply(a,[he,fe,ge,St,Rt]);break;case"mobile":(n=this.plugins).push.apply(n,[pe]);break;default:(s=this.plugins).push.apply(s,[he,fe,ge])}(ie.os.isIpad||h==="pc")&&this.plugins.push(gt);this.ignores=[];this.i18n=[]}));var xt=f((function e(){l(this,e);var t=[pe,Te,ye,ae,Ee,ne,Ze,se,re,$e,Ae,_e,oe];var i=[Me,le,Se,ue,de,ce,et,ot,ut];this.plugins=[be].concat(t,i);this.ignores=[];this.i18n=[Pe]}));var At={LANG:"zh-hk",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}};var Pt={LANG:"jp",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:""}},HAVE_NOTHING:"/",HAVE_METADATA:"/",HAVE_CURRENT_DATA:"/",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/ ",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/ ",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"",EXITCSSFULLSCREEN_TIPS:"",TEXTTRACK:"",PIP:"",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH:"",REFRESH_TIPS:"",FORWARD:"",LIVE_TIP:""}};var wt={LANG:"br",TEXT:{ERROR_TYPES:{network:{code:1,msg:"erro de download de vdeo"},mse:{code:2,msg:"erro de anexao de fluxo"},parse:{code:3,msg:"erro de anlise"},format:{code:4,msg:"formato incorreto"},decoder:{code:5,msg:"erro de decodificao"},runtime:{code:6,msg:"erros gramaticais"},timeout:{code:7,msg:"tempo limite de reproduo"},other:{code:8,msg:"outros erros"}},HAVE_NOTHING:"No h informaes sobre se o udio/vdeo est pronto",HAVE_METADATA:"Os metadados de udio/vdeo esto prontos ",HAVE_CURRENT_DATA:"Os dados sobre a localizao de reproduo atual esto disponveis, mas no h dados suficientes para reproduzir o prximo quadro/milissegundo",HAVE_FUTURE_DATA:"Atual e pelo menos um quadro de dados est disponvel",HAVE_ENOUGH_DATA:"Os dados disponveis so suficientes para comear a jogar",NETWORK_EMPTY:"O udio/vdeo no foi inicializado",NETWORK_IDLE:"O udio/vdeo est ativo e foi selecionado para recursos, mas nenhuma rede est sendo usada",NETWORK_LOADING:"O navegador est baixando os dados",NETWORK_NO_SOURCE:"Nenhuma fonte de udio/vdeo foi encontrada",MEDIA_ERR_ABORTED:"O processo de busca  abortado pelo usurio",MEDIA_ERR_NETWORK:"Ocorreu um erro durante o download",MEDIA_ERR_DECODE:"Ocorreu um erro durante a decodificao",MEDIA_ERR_SRC_NOT_SUPPORTED:"No h suporte para udio/vdeo",REPLAY:"Repetir",ERROR:"A rede est offline",PLAY_TIPS:"Reproduzir",PAUSE_TIPS:"Pausar",PLAYNEXT_TIPS:"Reproduzir prximo",DOWNLOAD_TIPS:"Baixar",ROTATE_TIPS:"Girar",RELOAD_TIPS:"Recarregar",FULLSCREEN_TIPS:"Tela cheia",EXITFULLSCREEN_TIPS:"Sair da tela cheia",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Sair da cssfullscreen",TEXTTRACK:"Legenda",PIP:"PIP",SCREENSHOT:"Captura de tela",LIVE:"AO VIVO",OFF:"Desligado",OPEN:"Abrir",MINI_DRAG:"Clique e segure para arrastar",MINISCREEN:"Minitela",REFRESH_TIPS:"Tente",REFRESH:"Atualizar",FORWARD:"encaminhar",LIVE_TIP:"Ao vivo"}};var Dt={LANG:"de",TEXT:{ERROR_TYPES:{network:{code:1,msg:"Fehler beim Herunterladen des Videos"},mse:{code:2,msg:"Fehler beim Anhngen des Streams"},parse:{code:3,msg:"Fehler beim Parsen"},format:{code:4,msg:"falsches Format"},decoder:{code:5,msg:"Dekodierungsfehler"},runtime:{code:6,msg:"grammatikalische Fehler"},timeout:{code:7,msg:"Wiedergabeunterbrechung"},other:{code:8,msg:"andere Fehler"}},HAVE_NOTHING:"Es sind keine Informationen darber vorhanden, ob Audio/Video wiedergabebereit ist",HAVE_METADATA:"Audio-/Video-Metadaten knnen genutzt werden ",HAVE_CURRENT_DATA:"Es sind Daten ber die aktuelle Wiedergabeposition verfgbar, jedoch reichen diese nicht aus, um den nchsten Frame / die nchste Millisekunde wiederzugeben",HAVE_FUTURE_DATA:"Das aktuelle und mindestens ein Datenframe ist verfgbar",HAVE_ENOUGH_DATA:"Die verfgbaren Daten reichen aus, um die Wiedergabe zu starten",NETWORK_EMPTY:"Audio/Video wurde nicht initialisiert",NETWORK_IDLE:"Audio/Video ist aktiv und wurde fr die Ressourcen ausgewhlt, aber es wird kein Netzwerk verwendet",NETWORK_LOADING:"Der Browser ldt die Daten herunter",NETWORK_NO_SOURCE:"Keine Audio-/Videoquelle gefunden",MEDIA_ERR_ABORTED:"Der Abrufvorgang wurde vom Benutzer abgebrochen",MEDIA_ERR_NETWORK:"Beim Herunterladen ist ein Fehler aufgetreten",MEDIA_ERR_DECODE:"Bei der Entschlsselung ist ein Fehler aufgetreten",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/Video wird nicht untersttzt",REPLAY:"Erneute Wiedergabe",ERROR:"Das Netzwerk ist offline",PLAY_TIPS:"Wiedergabe",PAUSE_TIPS:"Anhalten",PLAYNEXT_TIPS:"Nchstes wiedergeben",DOWNLOAD_TIPS:"Herunterladen",ROTATE_TIPS:"Drehen",RELOAD_TIPS:"Neu laden",FULLSCREEN_TIPS:"Vollbildschirm",EXITFULLSCREEN_TIPS:"Vollbildschirm beenden",CSSFULLSCREEN_TIPS:"CSS-Vollbildschirm",EXITCSSFULLSCREEN_TIPS:"CSS-Vollbildschirm beenden",TEXTTRACK:"Beschriftung",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LIVE",OFF:"Aus",OPEN:"ffnen",MINI_DRAG:"Klicken und zum Ziehen halten",MINISCREEN:"Miniaturbildschirm",REFRESH_TIPS:"Bitte versuchen",REFRESH:"Aktualisieren",FORWARD:"weiterleiten",LIVE_TIP:"Live"}};var Lt={LANG:"es",TEXT:{ERROR_TYPES:{network:{code:1,msg:"error de descarga de vdeo"},mse:{code:2,msg:"error al aadir emisin"},parse:{code:3,msg:"error de anlisis"},format:{code:4,msg:"formato incorrecto"},decoder:{code:5,msg:"error de descodificacin"},runtime:{code:6,msg:"errores gramaticales"},timeout:{code:7,msg:"tiempo de espera de reproduccin agotado"},other:{code:8,msg:"otros errores"}},HAVE_NOTHING:"No hay informacin sobre si el audio o el vdeo estn listos",HAVE_METADATA:"Los metadatos de audio o vdeo estn listos ",HAVE_CURRENT_DATA:"Los datos sobre la ubicacin de reproduccin actual estn disponibles, pero no hay suficientes datos para reproducir el siguiente marco/milisegundo",HAVE_FUTURE_DATA:"El marco de datos actual y al menos uno ms estn disponibles",HAVE_ENOUGH_DATA:"Los datos disponibles son suficientes para iniciar la reproduccin",NETWORK_EMPTY:"El audio o el vdeo no se han iniciado",NETWORK_IDLE:"El audio o el vdeo estn activos y se han seleccionado para los recursos, pero no se utiliza ninguna red",NETWORK_LOADING:"El navegador est descargando los datos",NETWORK_NO_SOURCE:"No se ha encontrado ninguna fuente de audio o vdeo",MEDIA_ERR_ABORTED:"El usuario ha cancelado el proceso de recuperacin",MEDIA_ERR_NETWORK:"Se ha producido un error al descargar",MEDIA_ERR_DECODE:"Se ha producido un error al descodificar",MEDIA_ERR_SRC_NOT_SUPPORTED:"El audio o el vdeo no son compatibles",REPLAY:"Volver a reproducir",ERROR:"La red est fuera de lnea",PLAY_TIPS:"Reproducir",PAUSE_TIPS:"Pausar",PLAYNEXT_TIPS:"Reproducir siguiente",DOWNLOAD_TIPS:"Descargar",ROTATE_TIPS:"Girar",RELOAD_TIPS:"Cargar de nuevo",FULLSCREEN_TIPS:"Pantalla completa",EXITFULLSCREEN_TIPS:"Salir de la pantalla completa",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Salir de cssfullscreen",TEXTTRACK:"Subttulo",PIP:"PIP",SCREENSHOT:"Captura de pantalla",LIVE:"EN DIRECTO",OFF:"Desactivado",OPEN:"Abrir",MINI_DRAG:"Haz clic y mantn pulsado para arrastrar",MINISCREEN:"Minipantalla",REFRESH_TIPS:"Intntalo",REFRESH:"Volver a cargar",FORWARD:"reenviar",LIVE_TIP:"En directo"}};var Ot={LANG:"fr",TEXT:{ERROR_TYPES:{network:{code:1,msg:"erreur de tlchargement vido"},mse:{code:2,msg:"erreur d'ajout du stream"},parse:{code:3,msg:"erreur d'analyse"},format:{code:4,msg:"format erron"},decoder:{code:5,msg:"erreur de dcodage"},runtime:{code:6,msg:"erreurs grammaticales"},timeout:{code:7,msg:"lecture expire"},other:{code:8,msg:"autres erreurs"}},HAVE_NOTHING:"Il n'y a pas d'information sur la disponibilit de l'audio/vido",HAVE_METADATA:"Les mtadonnes audio/vido sont prtes ",HAVE_CURRENT_DATA:"Les donnes relatives  l'emplacement de lecture actuel sont disponibles, mais les donnes ne sont pas suffisantes pour lire l'image/la milliseconde suivante",HAVE_FUTURE_DATA:"Trame de donnes actuelles (au moins une) disponible",HAVE_ENOUGH_DATA:"Les donnes disponibles sont suffisantes pour dmarrer la lecture",NETWORK_EMPTY:"L'audio/vido n'a pas t initialis",NETWORK_IDLE:"L'audio/vido est actif et a t slectionn comme ressource, mais aucun rseau n'est utilis",NETWORK_LOADING:"Le navigateur tlcharge les donnes",NETWORK_NO_SOURCE:"Aucune source audio/vido n'a t trouve",MEDIA_ERR_ABORTED:"Le processus de recherche est interrompu par l'utilisateur",MEDIA_ERR_NETWORK:"Une erreur s'est produite lors du tlchargement",MEDIA_ERR_DECODE:"Une erreur s'est produite lors du dcodage",MEDIA_ERR_SRC_NOT_SUPPORTED:"L'audio/vido n'est pas pris en charge",REPLAY:"Relancer",ERROR:"Le rseau est hors ligne",PLAY_TIPS:"Lire",PAUSE_TIPS:"Mettre en pause",PLAYNEXT_TIPS:"Lire l'lment suivant",DOWNLOAD_TIPS:"Tlcharger",ROTATE_TIPS:"Pivoter",RELOAD_TIPS:"Actualiser",FULLSCREEN_TIPS:"Plein cran",EXITFULLSCREEN_TIPS:"Quitter le plein cran",CSSFULLSCREEN_TIPS:"Plein cran css",EXITCSSFULLSCREEN_TIPS:"Quitter le plein cran css",TEXTTRACK:"Lgende",PIP:"PIP",SCREENSHOT:"Capture d'cran",LIVE:"EN DIRECT",OFF:"Dsactiv",OPEN:"Ouvrir",MINI_DRAG:"Cliquer et maintenir pour faire glisser",MINISCREEN:"Mini cran",REFRESH_TIPS:"Essayez",REFRESH:"Actualiser",FORWARD:"transfrer",LIVE_TIP:"En direct"}};var bt={LANG:"id",TEXT:{ERROR_TYPES:{network:{code:1,msg:"kesalahan unduh video"},mse:{code:2,msg:"kesalahan penambahan stream"},parse:{code:3,msg:"kesalahan penguraian"},format:{code:4,msg:"format salah"},decoder:{code:5,msg:"kesalahan dekode"},runtime:{code:6,msg:"kesalahan tata bahasa"},timeout:{code:7,msg:"waktu pemutaran habis"},other:{code:8,msg:"kesalahan lainnya"}},HAVE_NOTHING:"Tidak ada informasi mengenai apakah audio/video sudah siap",HAVE_METADATA:"Metadata audio/video siap ",HAVE_CURRENT_DATA:"Data mengenai lokasi pemutaran saat ini tersedia, tetapi data tidak cukup untuk memutar bingkai berikutnya/milidetik",HAVE_FUTURE_DATA:"Data saat ini dan setidaknya satu bingkai data tersedia",HAVE_ENOUGH_DATA:"Data yang tersedia cukup untuk mulai memutar",NETWORK_EMPTY:"Audio/video belum diinisialisasi",NETWORK_IDLE:"Audio/video sedang aktif dan telah dipilih untuk sumber daya, tetapi tidak ada jaringan yang digunakan",NETWORK_LOADING:"Peramban sedang mengunduh data",NETWORK_NO_SOURCE:"Tidak ada sumber audio/video yang ditemukan",MEDIA_ERR_ABORTED:"Proses pengambilan dihentikan oleh pengguna",MEDIA_ERR_NETWORK:"Terjadi kesalahan ketika mengunduh",MEDIA_ERR_DECODE:"Terjadi kesalahan ketika mendekode",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video tidak didukung",REPLAY:"Putar ulang",ERROR:"Jaringan offline",PLAY_TIPS:"Putar",PAUSE_TIPS:"Jeda",PLAYNEXT_TIPS:"Putar berikutnya",DOWNLOAD_TIPS:"Unduh",ROTATE_TIPS:"Putar",RELOAD_TIPS:"Muat ulang",FULLSCREEN_TIPS:"Layar penuh",EXITFULLSCREEN_TIPS:"Keluar dari layar penuh",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Keluar dari cssfullscreen",TEXTTRACK:"Keterangan",PIP:"PIP",SCREENSHOT:"Screenshot",LIVE:"LANGSUNG",OFF:"Tidak Aktif",OPEN:"Buka",MINI_DRAG:"Klik dan tahan untuk menarik",MINISCREEN:"Layar mini",REFRESH_TIPS:"Silakan Coba",REFRESH:"Segarkan",FORWARD:"teruskan",LIVE_TIP:"Langsung"}};var Nt={LANG:"it",TEXT:{ERROR_TYPES:{network:{code:1,msg:"errore di download del video"},mse:{code:2,msg:"errore di accodamento del flusso"},parse:{code:3,msg:"errore di analisi"},format:{code:4,msg:"formato errato"},decoder:{code:5,msg:"errore di decodifica"},runtime:{code:6,msg:"errori grammaticali"},timeout:{code:7,msg:"timeout della riproduzione"},other:{code:8,msg:"altri errori"}},HAVE_NOTHING:"Non ci sono informazioni che indichino se l'audio/il video  pronto",HAVE_METADATA:"I metadati audio/video sono pronti ",HAVE_CURRENT_DATA:"I dati sulla posizione corrente di riproduzione sono disponibili, ma non ci sono dati sufficienti per riprodurre il prossimo frame/millisecondo",HAVE_FUTURE_DATA:"Corrente e almeno un frame di dati  disponibile",HAVE_ENOUGH_DATA:"I dati disponibili sono sufficienti per avviare la riproduzione",NETWORK_EMPTY:"L'audio/Il video non  stato inizializzato",NETWORK_IDLE:"L'audio/Il video  attivo ed  stato selezionato per le risorse, ma non viene utilizzata alcuna rete",NETWORK_LOADING:"Il browser sta scaricando i dati",NETWORK_NO_SOURCE:"Nessuna origine audio/video trovata",MEDIA_ERR_ABORTED:"Il processo di recupero  stato interrotto dall'utente",MEDIA_ERR_NETWORK:"Si  verificato un errore durante il download",MEDIA_ERR_DECODE:"Si  verificato un errore durante la decodificazione",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/Video non supportato",REPLAY:"Riproduci di nuovo",ERROR:"Rete offline",PLAY_TIPS:"Riproduci",PAUSE_TIPS:"Sospendi",PLAYNEXT_TIPS:"Riproduci successivo",DOWNLOAD_TIPS:"Scarica",ROTATE_TIPS:"Ruota",RELOAD_TIPS:"Ricarica",FULLSCREEN_TIPS:"Schermo intero",EXITFULLSCREEN_TIPS:"Esci dallo schermo intero",CSSFULLSCREEN_TIPS:"Schermo intero CSS",EXITCSSFULLSCREEN_TIPS:"Esci dallo schermo intero CSS",TEXTTRACK:"Didascalia",PIP:"Immagine nell'immagine",SCREENSHOT:"Screenshot",LIVE:"IN DIRETTA",OFF:"Inattivo",OPEN:"Apri",MINI_DRAG:"Fai clic e tieni premuto per trascinare",MINISCREEN:"Minischermo",REFRESH_TIPS:"Prova",REFRESH:"Aggiorna",FORWARD:"inoltra",LIVE_TIP:"In diretta"}};var Mt={LANG:"kr",TEXT:{ERROR_TYPES:{network:{code:1,msg:"  "},mse:{code:2,msg:"  "},parse:{code:3,msg:"  "},format:{code:4,msg:" "},decoder:{code:5,msg:" "},runtime:{code:6,msg:" "},timeout:{code:7,msg:"  "},other:{code:8,msg:" "}},HAVE_NOTHING:"/     ",HAVE_METADATA:"/   ",HAVE_CURRENT_DATA:"         /    ",HAVE_FUTURE_DATA:"        ",HAVE_ENOUGH_DATA:"     ",NETWORK_EMPTY:"/  ",NETWORK_IDLE:"/        ",NETWORK_LOADING:"   ",NETWORK_NO_SOURCE:"/    ",MEDIA_ERR_ABORTED:"    ",MEDIA_ERR_NETWORK:"   ",MEDIA_ERR_DECODE:"   ",MEDIA_ERR_SRC_NOT_SUPPORTED:"/  ",REPLAY:"",ERROR:"  ",PLAY_TIPS:"",PAUSE_TIPS:" ",PLAYNEXT_TIPS:" ",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:" ",FULLSCREEN_TIPS:" ",EXITFULLSCREEN_TIPS:"  ",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"cssfullscreen ",TEXTTRACK:"",PIP:"PIP",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"   ",MINISCREEN:"",REFRESH_TIPS:" ",REFRESH:" ",FORWARD:"",LIVE_TIP:""}};var Ft={LANG:"ms-my",TEXT:{ERROR_TYPES:{network:{code:1,msg:"ralat muat turun video"},mse:{code:2,msg:"ralat menambahkan aliran"},parse:{code:3,msg:"ralat penghuraian"},format:{code:4,msg:"format salah"},decoder:{code:5,msg:"ralat mendekod"},runtime:{code:6,msg:"kesalahan tatabahasa"},timeout:{code:7,msg:"masa putar habis"},other:{code:8,msg:"kesalahan lain"}},HAVE_NOTHING:"Tiada maklumat sama ada audio/video sedia",HAVE_METADATA:"Metadata audio/video sedia ",HAVE_CURRENT_DATA:"Data tentang lokasi putar semasa tersedia, tetapi tidak cukup data untuk memainkan bingkai/milidetik seterusnya",HAVE_FUTURE_DATA:"Data semasa dan sekurang-kurangnya satu bingkai tersedia",HAVE_ENOUGH_DATA:"Data yang tersedia mencukupi untuk memulakan permainan",NETWORK_EMPTY:"Audio/video belum diinisialisasi",NETWORK_IDLE:"Audio/video aktif dan telah dipilih untuk sumber, tetapi tiada rangkaian digunakan",NETWORK_LOADING:"Pelayar sedang memuat turun data",NETWORK_NO_SOURCE:"Tiada sumber audio/video ditemui",MEDIA_ERR_ABORTED:"Proses pengambilan dibatalkan oleh pengguna",MEDIA_ERR_NETWORK:"Ralat berlaku semasa muat turun",MEDIA_ERR_DECODE:"Ralat berlaku semasa mendekod",MEDIA_ERR_SRC_NOT_SUPPORTED:"Audio/video tidak disokong",REPLAY:"Main semula",ERROR:"Rangkaian offline",PLAY_TIPS:"Putar",PAUSE_TIPS:"Jeda",PLAYNEXT_TIPS:"Putar seterusnya",DOWNLOAD_TIPS:"Muat turun",ROTATE_TIPS:"Putar",RELOAD_TIPS:"Muat semula",FULLSCREEN_TIPS:"Skrin penuh",EXITFULLSCREEN_TIPS:"Keluar skrin penuh",CSSFULLSCREEN_TIPS:"Cssskrin penuh",EXITCSSFULLSCREEN_TIPS:"Keluar cssskrin penuh",TEXTTRACK:"Kapsyen",PIP:"PIP",SCREENSHOT:"Tangkapan skrin",LIVE:"LIVE",OFF:"Matikan",OPEN:"Buka",MINI_DRAG:"Klik dan tahan untuk seret",MINISCREEN:"Miniscreen",REFRESH_TIPS:"Sila Cuba",REFRESH:"Segarkan",FORWARD:"ke hadapan",LIVE_TIP:"Langsung"}};var Ht={LANG:"ru",TEXT:{ERROR_TYPES:{network:{code:1,msg:"  "},mse:{code:2,msg:"  "},parse:{code:3,msg:"  "},format:{code:4,msg:" "},decoder:{code:5,msg:" "},runtime:{code:6,msg:" "},timeout:{code:7,msg:"- "},other:{code:8,msg:" "}},HAVE_NOTHING:"    /",HAVE_METADATA:" /  ",HAVE_CURRENT_DATA:"     ,       /",HAVE_FUTURE_DATA:"       ",HAVE_ENOUGH_DATA:"     ",NETWORK_EMPTY:"/  ",NETWORK_IDLE:"/     ,    ",NETWORK_LOADING:"  ",NETWORK_NO_SOURCE:" /  ",MEDIA_ERR_ABORTED:"   ",MEDIA_ERR_NETWORK:"   ",MEDIA_ERR_DECODE:"   ",MEDIA_ERR_SRC_NOT_SUPPORTED:"/  ",REPLAY:" ",ERROR:"  ",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:" ",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:" ",EXITFULLSCREEN_TIPS:"   ",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"  cssfullscreen",TEXTTRACK:"",PIP:"  ",SCREENSHOT:" ",LIVE:" ",OFF:"",OPEN:"",MINI_DRAG:"  ,  ",MINISCREEN:"-",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:" "}};var Ut={LANG:"th",TEXT:{ERROR_TYPES:{network:{code:1,msg:""},mse:{code:2,msg:""},parse:{code:3,msg:""},format:{code:4,msg:""},decoder:{code:5,msg:""},runtime:{code:6,msg:""},timeout:{code:7,msg:""},other:{code:8,msg:" "}},HAVE_NOTHING:"/",HAVE_METADATA:"/ ",HAVE_CURRENT_DATA:" /",HAVE_FUTURE_DATA:"",HAVE_ENOUGH_DATA:"",NETWORK_EMPTY:"/",NETWORK_IDLE:"/ ",NETWORK_LOADING:"",NETWORK_NO_SOURCE:"/",MEDIA_ERR_ABORTED:"",MEDIA_ERR_NETWORK:"",MEDIA_ERR_DECODE:"",MEDIA_ERR_SRC_NOT_SUPPORTED:"/",REPLAY:"",ERROR:"",PLAY_TIPS:"",PAUSE_TIPS:"",PLAYNEXT_TIPS:"",DOWNLOAD_TIPS:"",ROTATE_TIPS:"",RELOAD_TIPS:"",FULLSCREEN_TIPS:"",EXITFULLSCREEN_TIPS:"",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:" cssfullscreen",TEXTTRACK:"",PIP:"PIP",SCREENSHOT:"",LIVE:"",OFF:"",OPEN:"",MINI_DRAG:"",MINISCREEN:"",REFRESH_TIPS:"",REFRESH:"",FORWARD:"",LIVE_TIP:""}};var Wt={LANG:"vn",TEXT:{ERROR_TYPES:{network:{code:1,msg:"li ti video v"},mse:{code:2,msg:"li ni lung"},parse:{code:3,msg:"li phn tch c php"},format:{code:4,msg:"sai nh dng"},decoder:{code:5,msg:"li gii m"},runtime:{code:6,msg:"li ng php"},timeout:{code:7,msg:"ht thi gian pht"},other:{code:8,msg:"li khc"}},HAVE_NOTHING:"Khng c thng tin v vic m thanh/video  sn sng hay cha",HAVE_METADATA:"Siu d liu v m thanh/video  sn sng ",HAVE_CURRENT_DATA:" c d liu v v tr pht hin ti, nhng khng c  d liu  pht khung hnh/mili giy tip theo",HAVE_FUTURE_DATA:"Hin ti v c t nht mt khung d liu kh dng",HAVE_ENOUGH_DATA:"D liu kh dng    bt u pht",NETWORK_EMPTY:"Cha khi to m thanh/video",NETWORK_IDLE:"m thanh/video ang hot ng v  c chn lm ti nguyn nhng khng c mng no c s dng",NETWORK_LOADING:"Trnh duyt ang ti d liu v",NETWORK_NO_SOURCE:"Khng tm thy ngun m thanh/video",MEDIA_ERR_ABORTED:"Ngi dng  hy b quy trnh tm np",MEDIA_ERR_NETWORK:" xy ra li khi ti v",MEDIA_ERR_DECODE:" xy ra li khi gii m",MEDIA_ERR_SRC_NOT_SUPPORTED:"m thanh/video khng c h tr",REPLAY:"Pht li",ERROR:"Mng ang ngoi tuyn",PLAY_TIPS:"Pht",PAUSE_TIPS:"Tm dng",PLAYNEXT_TIPS:"Pht tip",DOWNLOAD_TIPS:"Ti v",ROTATE_TIPS:"Xoay",RELOAD_TIPS:"Ti li",FULLSCREEN_TIPS:"Ton mn hnh",EXITFULLSCREEN_TIPS:"Thot ch  ton mn hnh",CSSFULLSCREEN_TIPS:"Cssfullscreen",EXITCSSFULLSCREEN_TIPS:"Thot ch  cssfullscreen",TEXTTRACK:"Ch thch",PIP:"PIP",SCREENSHOT:"nh chp mn hnh",LIVE:"TRC TIP",OFF:"Tt",OPEN:"M",MINI_DRAG:"Nhp gi  ko",MINISCREEN:"Mn hnh nh",REFRESH_TIPS:"Vui lng th",REFRESH:"Lm mi",FORWARD:"chuyn tip",LIVE_TIP:"Pht trc tip"}};function Vt(){return(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="-5 -11 40 40" width="40" height="40">\n  <path fill="#f85959" transform="scale(0.8 0.8)" d="M36.5,18.73a1.19,1.19,0,0,0,1-1.14V16.33a1.2,1.2,0,0,0-1-1.13l-.61-.08a1.75,1.75,0,0,1-1.3-.86l-.21-.36-.2-.36A1.72,1.72,0,0,1,34,12l.23-.58a1.18,1.18,0,0,0-.5-1.42l-1.1-.62a1.18,1.18,0,0,0-1.47.3l-.39.51a1.82,1.82,0,0,1-1.41.72c-.44,0-1.88-.27-2.22-.7l-.39-.49a1.18,1.18,0,0,0-1.48-.28l-1.09.64a1.19,1.19,0,0,0-.47,1.43l.25.59a1.87,1.87,0,0,1-.08,1.58c-.26.37-1.17,1.5-1.71,1.58l-.63.09a1.19,1.19,0,0,0-1,1.14l0,1.27a1.17,1.17,0,0,0,1,1.12l.61.08a1.74,1.74,0,0,1,1.3.87l.21.36.2.35A1.69,1.69,0,0,1,24,22.08l-.23.59a1.19,1.19,0,0,0,.5,1.42l1.1.62a1.19,1.19,0,0,0,1.48-.31l.38-.5a1.83,1.83,0,0,1,1.41-.72c.44,0,1.88.25,2.22.69l.39.49a1.18,1.18,0,0,0,1.48.28L33.86,24a1.19,1.19,0,0,0,.47-1.43L34.09,22a1.84,1.84,0,0,1,.07-1.58c.26-.37,1.17-1.5,1.72-1.58ZM31,18.94a2.76,2.76,0,0,1-4.65-1.2A2.71,2.71,0,0,1,27,15.13a2.76,2.76,0,0,1,4.64,1.2A2.7,2.7,0,0,1,31,18.94Z"/>\n  <path fill="#f85959" transform="scale(0.8 0.8)" d="M32,0H3.59A3.59,3.59,0,0,0,0,3.59v17A3.59,3.59,0,0,0,3.59,24.2H19.72a12.59,12.59,0,0,1-.81-1.2A11.73,11.73,0,0,1,35.54,7.28V3.59A3.59,3.59,0,0,0,32,0ZM13,14.18H4.29a1.52,1.52,0,0,1,0-3H13a1.52,1.52,0,0,1,0,3ZM16.45,8H4.29a1.51,1.51,0,0,1,0-3H16.45a1.51,1.51,0,1,1,0,3Z"/>\n</svg>\n',"image/svg+xml").firstChild}var jt=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);a.set={speed:1,area:{},opacity:1,fonSize:"middle"};return a}f(i,[{key:"afterCreate",value:function(){ie.device==="mobile"?this.activeEvent="click":this.activeEvent="mouseenter";this.onStateChange=this.onStateChange.bind(this);this.onToggle=this.onToggle.bind(this);this.bind(this.activeEvent,this.onToggle);this.bind("mouseleave",this.onToggle);this.appendChild(".xgplayer-panel-icon",Vt())}},{key:"onStateChange",value:function(e){this.config.onChangeSet&&this.config.onChangeSet(this.set)}},{key:"onToggle",value:function(e){e.preventDefault();e.stopPropagation();h.hasClass(this.root,"slider-show")?h.removeClass(this.root,"slider-show"):h.addClass(this.root,"slider-show")}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.onStateChange)}},{key:"render",value:function(){return'\n      <xg-icon class="xgplayer-panel">\n          <xg-panel-icon class="xgplayer-panel-icon">\n          </xg-panel-icon>\n          <xg-panel-slider class="xgplayer-panel-slider">\n            <xg-hidemode class="xgplayer-hidemode">\n              <p class="xgplayer-hidemode-font"></p>\n              <ul class="xgplayer-hidemode-radio">\n                <li class="xgplayer-hidemode-scroll" id="false"></li><li class="xgplayer-hidemode-top" id="false"></li><li class="xgplayer-hidemode-bottom" id="false"></li><li class="xgplayer-hidemode-color" id="false"></li>\n              </ul>\n            </xg-hidemode>\n            <xg-transparency class="xgplayer-transparency">\n              <span></span>\n              <input class="xgplayer-transparency-line xgplayer-transparency-color xgplayer-transparency-bar xgplayer-transparency-gradient" type="range" min="0" max="100" step="0.1" value="50"></input>\n            </xg-transparency>\n            <xg-showarea class="xgplayer-showarea">\n              <div class="xgplayer-showarea-name"></div>\n              <div class="xgplayer-showarea-control">\n                <div class="xgplayer-showarea-control-up">\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-onequarters">1/4</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-twoquarters selected-color">1/2</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-threequarters">3/4</span>\n                  <span class="xgplayer-showarea-control-up-item xgplayer-showarea-full">1</span>\n                </div>\n                <div class="xgplayer-showarea-control-down">\n                  <div class="xgplayer-showarea-control-down-dots">\n                    <span class="xgplayer-showarea-onequarters-dot"></span>\n                    <span class="xgplayer-showarea-twoquarters-dot"></span>\n                    <span class="xgplayer-showarea-threequarters-dot"></span>\n                    <span class="xgplayer-showarea-full-dot"></span>\n                  </div>\n                  <input class="xgplayer-showarea-line xgplayer-showarea-color xgplayer-showarea-bar xgplayer-gradient" type="range" min="1" max="4" step="1" value="1">\n                </div>\n              </div>\n            </xg-showarea>\n            <xg-danmuspeed class="xgplayer-danmuspeed">\n              <div class="xgplayer-danmuspeed-name"></div>\n              <div class="xgplayer-danmuspeed-control">\n                <div class="xgplayer-danmuspeed-control-up">\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-small"></span>\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-middle selected-color"></span>\n                  <span class="xgplayer-danmuspeed-control-up-item xgplayer-danmuspeed-large"></span>\n                </div>\n                <div class="xgplayer-danmuspeed-control-down">\n                  <div class="xgplayer-danmuspeed-control-down-dots">\n                    <span class="xgplayer-danmuspeed-small-dot"></span>\n                    <span class="xgplayer-danmuspeed-middle-dot"></span>\n                    <span class="xgplayer-danmuspeed-large-dot"></span>\n                  </div>\n                  <input class="xgplayer-danmuspeed-line xgplayer-danmuspeed-color xgplayer-danmuspeed-bar xgplayer-gradient" type="range" min="50" max="150" step="50" value="100">\n                </div>\n              </div>\n            </xg-danmuspeed>\n            <xg-danmufont class="xgplayer-danmufont">\n              <div class="xgplayer-danmufont-name"></div>\n              <div class="xgplayer-danmufont-control">\n                <div class="xgplayer-danmufont-control-up">\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-small"></span>\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-middle"></span>\n                  <span class="xgplayer-danmufont-control-up-item xgplayer-danmufont-large selected-color"></span>\n                </div>\n                <div class="xgplayer-danmufont-control-down">\n                  <div class="xgplayer-danmufont-control-down-dots">\n                    <span class="xgplayer-danmufont-small-dot"></span>\n                    <span class="xgplayer-danmufont-middle-dot"></span>\n                    <span class="xgplayer-danmufont-large-dot"></span>\n                  </div>\n                  <input class="xgplayer-danmufont-line xgplayer-danmufont-color xgplayer-danmufont-bar xgplayer-gradient" type="range" min="20" max="30" step="5" value="25">\n                </div>\n              </div>\n            </xg-danmufont>\n          </xg-panel-slider>\n      </xg-icon>'}}],[{key:"pluginName",get:function(){return"danmuPanel"}},{key:"defaultConfig",get:function(){return{position:O.CONTROLS_RIGHT,index:11,onChangeSet:function(e){console.log("DanmuPanel:".concat(e))},speed:1,area:{},opacity:1,fonSize:"middle"}}}]);return i}(w);var Kt='<dk-switch class="danmu-switch">\n<span class="txt"></span>\n</dk-switch>';var Bt=function(e){r(i,e);var t=o(i);function i(){l(this,i);return t.apply(this,arguments)}f(i,[{key:"afterCreate",value:function(){this.initIcons();this.onStateChange=this.onStateChange.bind(this);this.bind(["click","touchend"],this.onStateChange)}},{key:"registerIcons",value:function(){return{openDanmu:{icon:Kt,class:"danmu-switch-open"},closeDanmu:{icon:Kt,class:"danmu-switch-closed"}}}},{key:"switchState",value:function(e){e?this.setAttr("data-state","active"):this.setAttr("data-state","normal");this.switchTips(e)}},{key:"initIcons",value:function(){var e=this.icons;var t=this.find(".xgplayer-icon");t.appendChild(e.openDanmu);t.appendChild(e.closeDanmu)}},{key:"switchTips",value:function(e){var t=this.find(".xg-tips");t&&this.changeLangTextKey(t,e?"OFF":"OPEN")}},{key:"onStateChange",value:function(e){e.preventDefault();e.stopPropagation();var t=this.root.getAttribute("data-state");var i=t==="active";this.switchState(!i);this.config.onSwitch&&this.config.onSwitch(e,!i)}},{key:"destroy",value:function(){this.unbind(["click","touchend"],this.getMini)}},{key:"render",value:function(){var e="OPEN";return'\n    <xg-icon class="danmu-icon">\n      <div class="xgplayer-icon">\n      </div>\n      '.concat(ve(this,e,this.playerConfig.isHideTips),"\n    </xg-icon>")}}],[{key:"pluginName",get:function(){return"danmuIcon"}},{key:"defaultConfig",get:function(){return{position:O.CONTROLS_RIGHT,index:11,onSwitch:function(e,t){}}}}]);return i}(w);var Gt=300;var Yt=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);a.danmujs=null;a.danmuPanel=null;a.isOpen=false;a.seekCost=0;a.intervalId=0;a.isUseClose=false;return a}f(i,[{key:"afterCreate",value:function(){var e=this;this.playerConfig.isLive&&(this.config.isLive=true);this.initDanmu();this.registerExtIcons();this.once(x,(function(){e.config.defaultOpen&&!e.isUseClose&&e.start()}));this.on(F,(function(){e.isOpen&&e.danmujs&&e.danmujs.pause()}));this.on(L,(function(){e.isOpen&&e.danmujs&&e.danmujs.play()}));this.on(m,(function(){e.seekCost=window.performance.now();!e.config.isLive&&e.danmujs&&e.danmujs.stop()}));this.on(B,(function(){e.resize()}));this.on(v,(function(){if(e.danmujs&&e.isOpen){if(e.intervalId){h.clearTimeout(e,e.intervalId);e.intervalId=null}var t=window.performance.now();var i=t-e.seekCost>Gt?100:Gt;e.intervalId=h.setTimeout(e,(function(){e.danmujs.start();e.intervalId=null;e.player.paused&&e.danmujs.pause()}),i)}}))}},{key:"onPluginsReady",value:function(){var e=this.player.plugins.pc;if(e){e.onVideoDblClick&&this.bind("dblclick",e.onVideoDblClick);e.onVideoClick&&this.bind("click",e.onVideoClick)}}},{key:"initDanmu",value:function(){var e=this.player,t=this.config;var i=this.config,a=i.channelSize,n=i.fontSize,s=i.opacity,r=i.mouseControl,o=i.mouseControlPause,l=i.area,u=i.defaultOff;var d={container:this.root,player:e.media,comments:this.config.comments,live:t.isLive,defaultOff:u,area:l,mouseControl:r,mouseControlPause:o};t.ext&&Object.keys(t.ext).map((function(e){d[e]=t.ext[e]}));var c=new we(d);this.danmujs=c;e.danmu=c;this.setFontSize(n,a);this.setArea(l);this.resize();s!==1&&this.setOpacity(s)}},{key:"registerExtIcons",value:function(){var e=this;var t=this.player,i=this.config;if(i.panel&&t.controls){var a={config:{onChangeset:function(t){e.changeSet(t)}}};this.danmuPanel=t.controls.registerPlugin(jt,a,jt.pluginName)}var n=i.switchConfig;if(!i.closeDefaultBtn&&t.controls){var s={config:{onSwitch:function(t,i){e.onSwitch(t,i)}}};Object.keys(n).map((function(e){s.config[e]=n[e]}));this.danmuButton=t.controls.registerPlugin(Bt,s,Bt.pluginName);this.config.defaultOpen&&this.danmuButton.switchState(true)}}},{key:"changeSet",value:function(e){}},{key:"onSwitch",value:function(e,t){this.emitUserAction(e,"switch_danmu",{prop:"isOpen",from:!t,to:t});t?this.start():this.stop()}},{key:"start",value:function(){var e=this;if(!this.isOpen&&this.danmujs){this.isUseClose=false;this.show();this.resize();h.setTimeout(this,(function(){e.danmujs.start();e.player.paused&&e.danmujs.pause();e.isOpen=true}),0)}}},{key:"stop",value:function(){this.isUseClose=true;if(this.isOpen&&this.danmujs){this.danmujs.stop();this.config.isLive&&this.clear();this.isOpen=false;this.hide()}}},{key:"clear",value:function(){this.danmujs&&this.danmujs.clear()}},{key:"setCommentLike",value:function(e,t){this.danmujs&&this.danmujs.setCommentLike(e,t)}},{key:"setCommentDuration",value:function(e,t){this.danmujs&&this.danmujs.setCommentDuration(e,t)}},{key:"setAllDuration",value:function(e,t){this.danmujs&&this.danmujs.setAllDuration(e,t)}},{key:"setCommentID",value:function(e,t){this.danmujs&&this.danmujs.setCommentID(e,t)}},{key:"hideMode",value:function(e){this.danmujs&&this.danmujs.hide(e)}},{key:"showMode",value:function(e){this.danmujs&&this.danmujs.show(e)}},{key:"setArea",value:function(e){this.danmujs&&this.danmujs.setArea(e)}},{key:"setOpacity",value:function(e){this.danmujs&&this.danmujs.setOpacity(e)}},{key:"setFontSize",value:function(e,t){this.danmujs&&this.danmujs.setFontSize(e,t)}},{key:"resize",value:function(){this.danmujs&&this.danmujs.resize()}},{key:"sendComment",value:function(e){this.danmujs&&this.danmujs.sendComment(e)}},{key:"updateComments",value:function(e,t){this.danmujs&&this.danmujs.updateComments(e,t)}},{key:"hideIcon",value:function(){this.danmuButton&&this.danmuButton.hide()}},{key:"showIcon",value:function(){this.danmuButton&&this.danmuButton.show()}},{key:"destroy",value:function(){this.danmujs.stop();this.danmujs.destroy();this.danmujs=null;this.player.danmu=null;var e=this.danmuButton,t=this.danmuPanel;this.danmuButton&&this.danmuButton.root&&e.__destroy&&e.__destroy();this.danmuPanel&&this.danmuPanel.root&&t.__destroy&&t.__destroy();this.danmuButton=null;this.danmuPanel=null}},{key:"render",value:function(){return'<xg-danmu class="xgplayer-danmu">\n    </xg-danmu>'}}],[{key:"pluginName",get:function(){return"danmu"}},{key:"defaultConfig",get:function(){return{comments:[],area:{start:0,end:1},closeDefaultBtn:false,defaultOff:false,panel:false,panelConfig:{},switchConfig:{},defaultOpen:true,isLive:false,channelSize:24,fontSize:14,opacity:1,mouseControl:false,mouseControlPause:false,ext:{},style:{}}}}]);return i}(w);var Xt=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this);u(d(a),"_onChange",(function(e){var t=a._media.textTracks;if(t&&t.length!==0){var i=[];var n=[];var s=-1;for(var r=0;r<t.length;r++){var o=t[r];if(o.kind==="subtitles"){i.push({id:o.id||o.language,language:o.language,text:o.label,isDefault:o.mode==="showing"});s===-1&&o.mode==="showing"&&(s=r);n.push(o.language)}}if(n.join("|")!==a._languages){a._languages=n.join("|");a.emit("reset",{list:i,isOpen:s>-1})}else s===-1?a.emit("off"):a.curIndex!==s&&a.emit("change",i[s]);a.curIndex=s}}));a._media=e;a._list=[];a._languages="";a.curIndex=-1;a._init();return a}f(i,[{key:"_init",value:function(){var e=this._media.textTracks;e.addEventListener("change",this._onChange)}},{key:"switch",value:function(e){var t=this._media.textTracks;for(var i=0;i<t.length;i++){var a=t[i];a.language===e.language?a.mode="showing":a.mode==="showing"&&(a.mode="disabled")}}},{key:"switchOff",value:function(){var e=this._media.textTracks;for(var t=0;t<e.length;t++)e[t].mode="disabled";this.curIndex=-1}},{key:"destroy",value:function(){var e=this._media.textTracks;e.removeEventListener("change",this._onChange);this._media=null;this._list=[];this._languages="";this.curIndex=-1}}]);return i}(Ie);var zt={CLOSE:"close",OPEN:"open",TEXT_CLOSE:"text-close"};function Jt(e){var t=-1;e.forEach((function(e,i){e.id||e.language||(e.id=i);e.id=String(e.id);!e.url&&(e.url=e.src);!e.text&&(e.text=e.label);!e.language&&(e.language=e.srclang);e.isDefault===void 0&&(e.isDefault=e.default||false);(e.isDefault||e.default)&&(t<0?t=i:e.isDefault=e.default=false)}));return t}function qt(e,t){var i=h.isNotNull(e.id)&&h.isNotNull(t.id)&&e.id===t.id;var a=h.isNotNull(e.language)&&h.isNotNull(t.language)&&e.language===t.language;return i||a}var Zt=function(e){r(i,e);var t=o(i);function i(){var e;l(this,i);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];e=t.call.apply(t,[this].concat(n));u(d(e),"_onOff",(function(){e.switchOffSubtitle()}));u(d(e),"_onChange",(function(t){var i=e.getSubTitleIndex(e.config.list,t);i<0||e.updateCurItem(i,t)}));u(d(e),"_onListReset",(function(t){e.updateList(t)}));u(d(e),"clickSwitch",(function(t,i){var a=i.type===zt.CLOSE||i.type===zt.TEXT_CLOSE;e.subTitles&&(a?e.subTitles.switchOff():e.switchSubTitle({language:i.language,id:i.id}))}));u(d(e),"onIconClick",(function(t){e.curItem?e.subTitles.switchOff():e.switchOnSubtitle(t)}));u(d(e),"onPlayerFocus",(function(t){e.subTitles&&e.config.style.follow&&e.rePosition()}));u(d(e),"onPlayerBlur",(function(t){e.subTitles&&e.config.style.follow&&!e.playerConfig.marginControls&&e.subTitles.root&&(e.subTitles.root.style.transform="translate(0, 0)")}));return e}f(i,[{key:"beforeCreate",value:function(e){var t=e.player.config.texttrack||e.player.config.textTrack;h.typeOf(t)==="Array"&&(e.config.list=t)}},{key:"afterCreate",value:function(){var e=this.config,t=e.list,a=e.mode;var n=Jt(t);j(K(i.prototype),"afterCreate",this).call(this);this.curIndex=-1;this.lastIndex=-1;this.curItem=null;this._nativeTracks=null;this.handlerClickSwitch=this.hook("subtitle_change",this.clickSwitch);a==="native"?this._initNativeSubtitle():this._initExtSubTitle(n)}},{key:"_initNativeSubtitle",value:function(){var e=this.player;e._subTitles||(e._subTitles=new Xt(e.media));this.subTitles=e._subTitles;this.subTitles.on("off",this._onOff);this.subTitles.on("change",this._onChange);this.subTitles.on("reset",this._onListReset)}},{key:"_initExtSubTitle",value:function(e){var t=this.config,i=t.list,a=t.style,n=t.isDefaultOpen,s=t.updateMode,r=t.renderMode;if(n&&e<0&&i.length>0){e=0;i[0].isDefault=true}var o={subTitles:i,defaultOpen:n,updateMode:s,renderMode:r,debugger:this.config.debugger};Object.keys(a).map((function(e){o[e]=a[e]}));var l=!this.playerConfig.marginControls&&this.player.controls.root;if(l){this.on(ee,this.onPlayerFocus);this.on(te,this.onPlayerBlur)}var u=this.player;if(u._subTitles)u._subTitles._isOpen&&(e=this.getSubTitleIndex(this.config.list,u._subTitles.currentText));else{u._subTitles=new De(o);u._subTitles.attachPlayer(this.player)}this.subTitles=u._subTitles;this.subTitles.on("off",this._onOff);this.subTitles.on("change",this._onChange);this.subTitles.on("reset",this._onListReset);a.follow&&this.subTitles.root&&h.addClass(this.subTitles.root,"follow-control");this._renderList(i,n,e)}},{key:"_renderList",value:function(e,t,i){if(e&&e.length!==0){if(t){i=i<0?0:i;e[i].isDefault=true;this.curIndex=i;this.curItem=e[i];this.switchIconState(true)}else this.switchIconState(false);if(this.player.isCanplay&&e.length>0){this.renderItemList(e);this.show()}}}},{key:"registerIcons",value:function(){return{textTrackOpen:{icon:"",class:"xg-texttrak-open"},textTrackClose:{icon:"",class:"xg-texttrak-close"}}}},{key:"show",value:function(e){!this.config.list||this.config.list.length<1||h.addClass(this.root,"show")}},{key:"getSubTitleIndex",value:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{id:"",language:""};var i=-1;if(!t||!t.id&&!t.language)return i;e.forEach((function(e,a){qt(e,t)&&(i=a)}));return i}},{key:"updateSubtitles",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var t=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(e){this.updateList({list:e});this.subTitles&&this.subTitles.setSubTitles(this.config.list,this.curIndex>-1,t)}}},{key:"updateList",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(e.list){var t=[];e.list.forEach((function(e){t.push(e)}));var i=Jt(t);if(e.isOpen){this.curIndex=i;this.curItem=i>-1?t[i]:null}else{this.curIndex=-1;this.curItem=null}this.config.list=t;if(t.length>0)this.show();else{this.switchOffSubtitle();this.hide()}this.renderItemList()}}},{key:"switchSubTitle",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:"",language:""};this.switchIconState(true);var t=this.getSubTitleIndex(this.config.list,e);t<0||this.subTitles.switch(e).catch((function(e){}))}},{key:"switchOffSubtitle",value:function(e){this.emit("subtitle_change",{off:true,isListUpdate:false,list:[]});this.lastIndex=this.curIndex;this.curIndex=-1;this.curItem=null;this.switchIconState(false);this.renderItemList()}},{key:"switchOnSubtitle",value:function(){var e=this.config.list;var t=this.lastIndex>-1?this.lastIndex:0;var i=e[t];this.switchIconState(true);this.switchSubTitle(i)}},{key:"switchIconState",value:function(e){this.setAttr("data-state",e?"open":"close")}},{key:"onItemClick",value:function(e,t){var a=e.delegateTarget;var n=a.getAttribute("language");var s=a.getAttribute("data-id");var r=a.getAttribute("data-type");j(K(i.prototype),"onItemClick",this).apply(this,arguments);this.handlerClickSwitch(e,{language:n,id:s,type:r})}},{key:"changeCurrentText",value:function(){if(!this.isIcons){var e=this.config,t=e.list,i=e.closeText;var a=this.curIndex;if(a-1<0)this.find(".icon-text").innerHTML=this.getTextByLang(i,"iconText");else if(a-1<t.length){var n=t[a-1];if(!n)return;this.find(".icon-text").innerHTML=this.getTextByLang(n,"iconText")}}}},{key:"updateCurItem",value:function(e,t){this.curIndex=e;this.curItem=this.config.list[e-1];this.renderItemList();this.emit("subtitle_change",P({off:false,isListUpdate:false,list:[]},t))}},{key:"renderItemList",value:function(){var e=this;var t=this.config,a=t.list,n=t.closeText,s=t.needCloseText;var r=[];var o=this.curIndex;var l=this.curIndex;if(s){r.push({showText:this.getTextByLang(n),"data-type":zt.TEXT_CLOSE,selected:this.curIndex===-1});o++}a.map((function(t,i){var a={language:t.language||t.srclang||"","data-id":t.id||""};a.selected=e.curIndex===i;a.showText=e.getTextByLang(t);r.push(a)}));j(K(i.prototype),"renderItemList",this).call(this,r,o);this.curIndex=l;this.curItem=a[l]}},{key:"rePosition",value:function(){var e=this.config.style.fitVideo;var t=this.player.controls.root.getBoundingClientRect();var i=0-t.height;if(e){var a=this.player,n=a.video,s=a.root;var r=s.getBoundingClientRect(),o=r.height,l=r.width;var u=n.videoHeight,d=n.videoWidth;var c=parseInt(u/d*100,10);var h=c*l/100;h>o&&(h=o);var f=(o-h)/2-i;f<0&&(this.subTitles.root.style.transform="translate(0, ".concat(f,"px)"))}else this.subTitles.root.style.transform="translate(0, ".concat(i,"px)")}},{key:"destroy",value:function(){if(this.subTitles){this.subTitles.destroy();this.subTitles=null}j(K(i.prototype),"destroy",this).call(this)}}],[{key:"pluginName",get:function(){return"texttrack"}},{key:"defaultConfig",get:function(){return P(P({},me.defaultConfig),{},{position:O.CONTROLS_RIGHT,index:6,list:[],isDefaultOpen:true,style:{follow:true,mode:"stroke",followBottom:50,fitVideo:true,offsetBottom:2,baseSizeX:49,baseSizeY:28,minSize:16,minMobileSize:13,line:"double",fontColor:"#fff"},closeText:{text:"",iconText:""},needCloseText:true,className:"xgplayer-texttrack",hidePortrait:false,isShowIcon:true,renderMode:"normal",mode:"external",debugger:false})}}]);return i}(me);var Qt=function(e){r(i,e);var t=o(i);function i(e){var a;l(this,i);a=t.call(this,e);a.canvasHeight=0;a.canvasWidth=0;a.width=0;a.height=0;a.dataFloatLen=2;a.xData=[];a.yData=[];a.yMax=0;a._duration=0;a.curData=[];return a}f(i,[{key:"afterPlayerInit",value:function(){if(!this.root){this.createRoot();this.reset()}}},{key:"afterCreate",value:function(){var e=this;this.on(B,(function(){e.resize()}));this.on(U,(function(){e._duration=e.player.duration;e.reset()}))}},{key:"setConfig",value:function(e){var t=this;Object.keys(e).forEach((function(i){t.config[i]=e[i]}));this.reset()}},{key:"reset",value:function(){var e=this.config.data;this.setData(e);this.resize()}},{key:"createRoot",value:function(){if(!this.root){var e=this.config.mode;var t=this.player.plugins.progress;var i=t.root;var a=e==="activeShow"?"xg-heatmap-active-show":"xg-heatmap-normal";var n=h.createDom("div","",{},"xg-heatmap ".concat(a));var s=i.children.length>0?i.children[0]:null;i.insertBefore(n,s);this.root=n;var r=h.createDom("canvas","",{},"xg-heatmap-canvas");this.root.appendChild(r);this.root.style.height="".concat(this.config.height,"px");this.canvas=r}}},{key:"resize",value:function(){var e=this.config.dpi;var t=this.root.getBoundingClientRect(),i=t.width,a=t.height;if(i!==this.width||a*e!==this.height){this.width=i;this.height=a;this.canvas.width=this.canvasWidth=i*e;this.canvas.height=this.canvasHeight=a*e;this.yMax=0;if(this.curData.length){this.setData();this.drawLinePath()}}}},{key:"formatData",value:function(e,t,i){var a=[];if(e.length<1)return a;var n=parseInt(t*1e3,10);if(h.typeOf(e[0])==="Object"&&e[0].time!==void 0){if(!n)return a;var s=1;var r=0;e.forEach((function(e){var t=parseInt(e.time*1e3,10);r&&(s<0||e.time-r<s)&&(s=e.time-r);r=e.time;a.push(P(P({},e),{},{percent:t/n}))}));var o=a[0].time;if(o>0){var l=o-s>0?[o-s,0]:[0];l.forEach((function(e){var t=parseInt(e*1e3,10);a.unshift({time:e,score:i,percent:t/n})}))}var u=a[a.length-1];t-u.time>s&&[u.time+s,t].forEach((function(e){var t=parseInt(e*1e3,10);a.push({time:e,score:i,percent:t/n})}))}else e.forEach((function(e){a.push(e)}));return a}},{key:"_getX",value:function(e,t,i,a){return i.percent!==void 0?this.fixFloat(a*i.percent,this.dataFloatLen):this.fixFloat((e-1)*t,this.dataFloatLen)}},{key:"_getY",value:function(e,t,i){var a=this.config,n=a.maxValue,s=a.minValue;var r=s;r=e.score!==void 0?e.score:e;r=Math.min(r,n);r=Math.max(r,s);r/=t;r=1-r;r=this.fixFloat(r*i,this.dataFloatLen);return r}},{key:"setData",value:function(e){var t=this.config,i=t.maxValue,a=t.minValue,n=t.maxLength;e&&e.length&&(this.curData=this.formatData(e,this._duration,a));e=this.curData;if(!(e.length<1)){this.xData=[];this.yData=[];this.yMax=0;var s=i;var r=a;var o=s-r;var l=this.canvasHeight;var u=e.length;var d=u>n?this.fixFloat(u/n,this.dataFloatLen):1;u=parseInt(u/d);var c=this.canvasWidth/(u-1);c=this.fixFloat(c,this.dataFloatLen);if(!Number.isNaN(c)){var h=parseInt(this.fixFloat(d-1,0));var f=0;while(f<u){var g=this._getX(f,c,e[h],this.canvasWidth);this.xData.push(g);var p=this._getY(e[h],o,l);this.yMax=Math.max(this.yMax,l-p);this.yData.push(p);f++;h=parseInt(this.fixFloat(f*d,0))}}}}},{key:"_getFillStyle",value:function(e){var t=this.config,i=t.gradient,a=t.gradientColors,n=t.fillStyle;var s=n;if(i&&i.length===4){var r=e.createLinearGradient(i[0],i[1],i[2],i[3]);if(a.length<2)console.warn(this.pluginName,"gradientColors");else{a.forEach((function(e){r.addColorStop(e.start,e.color)}));s=r}}return s}},{key:"drawLinePath",value:function(){this.clearCanvas();var e=this.canvas.getContext("2d");var t=this.xData,i=this.yData;var a,n;var s=0;var r=this.config,o=r.lineWidth,l=r.alpha,u=r.strokeStyle;var d=this._getFillStyle(e);e.beginPath();e.lineWidth=o;e.globalAlpha=l;e.strokeStyle=u||d;e.fillStyle=d;e.moveTo(0,this.canvasHeight);a=t[s];n=i[s];while(a!==void 0&&n!==void 0){e.lineTo(a,n);s++;a=t[s];n=i[s]}e.lineTo(this.canvasWidth,this.canvasHeight);e.closePath();e.stroke();e.fill()}},{key:"clearCanvas",value:function(){this.canvas.width=this.canvasWidth;this.canvas.height=this.canvasHeight}},{key:"fixFloat",value:function(e,t){return typeof e==="number"?parseFloat(e.toFixed(t)):NaN}},{key:"render",value:function(){return""}}],[{key:"pluginName",get:function(){return"heatmap"}},{key:"defaultConfig",get:function(){return{lineWidth:0,dpi:2,alpha:.7,gradient:[],gradientColors:[],strokeStyle:"",fillColor:"#FA1F41",height:20,data:[],maxValue:100,minValue:0,maxLength:400,mode:"activeShow"}}}]);return i}(w);export{W as BasePlugin,ge as CssFullscreenIcon,Yt as Danmu,Bt as DanmuIcon,jt as DanmuPanel,kt as DefaultPreset,Ct as DefaultPresetEn,n as Errors,$ as Events,ae as FullscreenIcon,Qt as HeatMap,i as I18N,s as InstManager,ue as Loading,xt as MobilePreset,ye as PlayIcon,w as Plugin,Te as Progress,t as STATE_CLASS,a as SimplePlayer,ie as Sniffer,Se as Start,Zt as TextTrack,Ee as TimeIcon,h as Util,_e as VolumeIcon,It as default,wt as langBr,Dt as langDe,Lt as langEs,Ot as langFr,bt as langId,Nt as langIt,Pt as langJp,Mt as langKr,Ft as langMsMy,Ht as langRu,Ut as langTh,Wt as langVn,Pe as langZhCn,At as langZhHk};

